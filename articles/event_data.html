<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Stratigraphic Paleobiology for Event Data • StratPal</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Stratigraphic Paleobiology for Event Data">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">StratPal</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.6.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/StratPal.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/event_data.html">Stratigraphic Paleobiology for Event Data</a></li>
    <li><a class="dropdown-item" href="../articles/phenotypic_evolution.html">Stratigraphic Paleobiology for Phenotypic Evolution</a></li>
    <li><a class="dropdown-item" href="../articles/paleoTS_functionality.html">Usage with the paleoTS and evoTS package</a></li>
    <li><a class="dropdown-item" href="../articles/advanced_functionality.html">Advanced Functionality and Writing Extensions</a></li>
    <li><a class="dropdown-item" href="../articles/StratPal_docs.html">Documentation of defined S3 classes</a></li>
    <li><a class="dropdown-item" href="../articles/FossilSim_integration.html">Integration with the FossilSim and paleotree packages</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/MindTheGap-ERC/StratPal/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Stratigraphic Paleobiology for Event Data</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/MindTheGap-ERC/StratPal/blob/main/vignettes/event_data.Rmd" class="external-link"><code>vignettes/event_data.Rmd</code></a></small>
      <div class="d-none name"><code>event_data.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This vignette provides an introduction to stratigraphic paleobiology
applied to “<em>event type data</em>” such as location and age of
specimens, and first/last occurrences of taxa.</p>
<p>First, let’s load the required packages:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://mindthegap-erc.github.io/StratPal/">StratPal</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/MindTheGap-ERC/admtools" class="external-link">admtools</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="modeling-fossil-occurrences-and-firstlast-fossil-occurrences">Modeling fossil occurrences and first/last fossil occurrences<a class="anchor" aria-label="anchor" href="#modeling-fossil-occurrences-and-firstlast-fossil-occurrences"></a>
</h2>
<p>Location and age of fossil specimens and first/last occurrences of
taxa can be considered distinct events that occur at specific points in
time or stratigraphic positions. Up to a few notable exceptions, the
same principles apply to this “<em>event type data</em>”, so we treat
them together.</p>
<p>We model events as <em>point processes</em>. In the
<code>StratPal</code> package, we provide two functions to simulate
point processes:</p>
<ul>
<li><p><code>p3</code>, short for Poisson point process, to simulate
events that occur at a constant rate</p></li>
<li><p><code>p3_var_rate</code> for variable rate Poisson point
processes to simulate events that occur at variable rates
(e.g. extinction events)</p></li>
</ul>
<p>The usage of <code>p3</code> is straightforward:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># simulate fossil occurrences over one Myr with an average of 15 occurrences per Myr</span></span>
<span><span class="fu"><a href="../reference/p3.html">p3</a></span><span class="op">(</span>rate <span class="op">=</span> <span class="fl">15</span>, from <span class="op">=</span> <span class="fl">0</span>, to <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span>main <span class="op">=</span> <span class="st">"Fossil abundance"</span>,</span>
<span>       xlab <span class="op">=</span> <span class="st">"Time [Myr]"</span>,</span>
<span>       ylab <span class="op">=</span> <span class="st">"# Specimens"</span><span class="op">)</span></span></code></pre></div>
<p><img src="event_data_files/figure-html/unnamed-chunk-2-1.png" class="r-plt" alt="histogram of fossil occurrences appearing at a constant rate." width="700"></p>
<p>Note that due to to random fluctuations, the histogram can differ a
lot from the constant rate that we simulated. This effect is more
pronounced for low rates.</p>
<p>For <code>p3_var_rate</code>, you can pass either a function that
specifies the rate to <code>x</code>:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># return 100 occurrences by setting n parameter</span></span>
<span><span class="co"># note that negative rates (where sin &lt; 0) are ignored</span></span>
<span><span class="fu"><a href="../reference/p3_var_rate.html">p3_var_rate</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">sin</span>, from <span class="op">=</span> <span class="fl">0</span>, to <span class="op">=</span> <span class="fl">9</span>, n <span class="op">=</span> <span class="fl">100</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span>xlab <span class="op">=</span> <span class="st">"Time [Myr]"</span>,</span>
<span>       ylab<span class="op">=</span> <span class="st">"# Specimens"</span>,</span>
<span>       main <span class="op">=</span> <span class="st">"Fossil abundance"</span><span class="op">)</span></span></code></pre></div>
<p><img src="event_data_files/figure-html/unnamed-chunk-3-1.png" class="r-plt" alt="histogram of fossil occurrences appearing at a sinusoidal rate." width="700"></p>
<p>Alternatively, you can pass it two vectors <code>x</code> and
<code>y</code>. The rate is then determined by linear interpolation
between these vectors. This is equivalent to using the function
<code>approxfun(x,y, rule = 2)</code> as input for <code>x</code>.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># decline in last occurrences from 50 to 0 over 1 Myr</span></span>
<span><span class="fu"><a href="../reference/p3_var_rate.html">p3_var_rate</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">50</span>, <span class="fl">0</span><span class="op">)</span>, from <span class="op">=</span> <span class="fl">0</span>, to <span class="op">=</span> <span class="fl">1</span>, f_max <span class="op">=</span> <span class="fl">50</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span>xlab <span class="op">=</span> <span class="st">"Time [Myr]"</span>,</span>
<span>       main <span class="op">=</span> <span class="st">"Last occurrences"</span>,</span>
<span>       ylab <span class="op">=</span> <span class="st">"# Last occurrences"</span><span class="op">)</span></span></code></pre></div>
<p><img src="event_data_files/figure-html/unnamed-chunk-4-1.png" class="r-plt" alt="histogram of fossil occurrences droping to 0." width="700"></p>
<p>Keep in mind that it is only a matter of interpretation whether the
“events” produced by <code>p3</code> and <code>p3_var_rate</code> are
age/timing or locations of specimens from one taxon or of first/last
occurrences of multiple taxa. The conceptual framework holds for any
type of event type.</p>
<p><strong>Task:</strong> Model an “extinction event” with a background
rate of 3 species disappearing per Myr, and a peak in extinction rate
where the rate is 10-fold increased over an interval of 200 kyr. How
distinct is the peak in the histogram, and how much do the results
differ due to randomness when you run the simulation multiple times?</p>
</div>
<div class="section level2">
<h2 id="age-depth-models">Age-depth models<a class="anchor" aria-label="anchor" href="#age-depth-models"></a>
</h2>
<p>Throughout this examples, we use the age-depth models from 2 km and
12 km offshore in scenario A from <a href="#References">Hohmann et
al. (2024)</a>. See <code><a href="../reference/scenarioA.html">?scenarioA</a></code> and
<code><a href="../articles/StratPal.html">vignette("StratPal")</a></code> for details on scenario A.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">adm_2km</span> <span class="op">=</span> <span class="fu"><a href="https://mindthegap-erc.github.io/admtools/reference/tp_to_adm.html" class="external-link">tp_to_adm</a></span><span class="op">(</span>t <span class="op">=</span> <span class="va">scenarioA</span><span class="op">$</span><span class="va">t_myr</span>,   <span class="co"># 2 km from shore</span></span>
<span>                h <span class="op">=</span> <span class="va">scenarioA</span><span class="op">$</span><span class="va">h_m</span><span class="op">[</span>,<span class="st">"2km"</span><span class="op">]</span>,</span>
<span>                T_unit <span class="op">=</span> <span class="st">"Myr"</span>,</span>
<span>                L_unit <span class="op">=</span> <span class="st">"m"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">adm_12km</span> <span class="op">=</span> <span class="fu"><a href="https://mindthegap-erc.github.io/admtools/reference/tp_to_adm.html" class="external-link">tp_to_adm</a></span><span class="op">(</span>t <span class="op">=</span> <span class="va">scenarioA</span><span class="op">$</span><span class="va">t_myr</span>,  <span class="co"># 12 km from shore</span></span>
<span>                h <span class="op">=</span> <span class="va">scenarioA</span><span class="op">$</span><span class="va">h_m</span><span class="op">[</span>,<span class="st">"12km"</span><span class="op">]</span>,</span>
<span>                T_unit <span class="op">=</span> <span class="st">"Myr"</span>,</span>
<span>                L_unit <span class="op">=</span> <span class="st">"m"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">adm_2km</span>,       <span class="co"># plot age-depth model 2 km from shore</span></span>
<span>     lwd_acc <span class="op">=</span> <span class="fl">2</span>,   <span class="co"># plot thicker lines for intervals with sediment accumulation (lwd = line width)</span></span>
<span>     lty_destr <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="co"># don't plot destructive intervals/gaps (lty = line type)</span></span>
<span><span class="fu"><a href="https://mindthegap-erc.github.io/admtools/reference/T_axis_lab.html" class="external-link">T_axis_lab</a></span><span class="op">(</span><span class="op">)</span>        <span class="co"># add time axis label</span></span>
<span><span class="fu"><a href="https://mindthegap-erc.github.io/admtools/reference/L_axis_lab.html" class="external-link">L_axis_lab</a></span><span class="op">(</span><span class="op">)</span>        <span class="co"># add length axis label</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/title.html" class="external-link">title</a></span><span class="op">(</span><span class="st">"Age-depth model 2 km from shore"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">adm_12km</span>,      <span class="co"># plot age-depth model 12 km from shore</span></span>
<span>     lwd_acc <span class="op">=</span> <span class="fl">2</span>,   </span>
<span>     lty_destr <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://mindthegap-erc.github.io/admtools/reference/T_axis_lab.html" class="external-link">T_axis_lab</a></span><span class="op">(</span><span class="op">)</span> </span>
<span><span class="fu"><a href="https://mindthegap-erc.github.io/admtools/reference/L_axis_lab.html" class="external-link">L_axis_lab</a></span><span class="op">(</span><span class="op">)</span> </span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/title.html" class="external-link">title</a></span><span class="op">(</span><span class="st">"Age-depth model 12 km from shore"</span><span class="op">)</span></span></code></pre></div>
<p><img src="event_data_files/figure-html/figures-side-1.png" class="r-plt" alt="2 plots of age-depth models, one 2 km from shore and one 12 km from shore." width="50%"><img src="event_data_files/figure-html/figures-side-2.png" class="r-plt" alt="2 plots of age-depth models, one 2 km from shore and one 12 km from shore." width="50%"></p>
<p><strong>Task:</strong> Plot the sea level curve for scenario A, and
the water depth curves at the two locations. How is this connected to
the age-depth models, specifically to the presence and duration of gaps
and low/high sedimentation rates? You can use
<code>plot_sed_rate_t</code>, <code>get_hiat_list</code> and
<code>get_hiat_duration</code> from <code>admtools</code>.</p>
</div>
<div class="section level2">
<h2 id="Stratigraphic-distortions">Stratigraphic distortions of “event” type data<a class="anchor" aria-label="anchor" href="#Stratigraphic-distortions"></a>
</h2>
<p>Any event type data can directly be transformed using an age-depth
model via <code>time_to_strat</code>. Depending on how the events are
interpreted, we need to choose different options.</p>
<div class="section level3">
<h3 id="fossil-specimens">Fossil specimens<a class="anchor" aria-label="anchor" href="#fossil-specimens"></a>
</h3>
<p>Assuming the events are fossil specimens of one taxon, we can examine
where specimens appear in the stratigraphic column:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/p3.html">p3</a></span><span class="op">(</span>rate <span class="op">=</span> <span class="fl">200</span>, from <span class="op">=</span> <span class="fu"><a href="https://mindthegap-erc.github.io/admtools/reference/min_time.html" class="external-link">min_time</a></span><span class="op">(</span><span class="va">adm_2km</span><span class="op">)</span>, to <span class="op">=</span> <span class="fu"><a href="https://mindthegap-erc.github.io/admtools/reference/max_time.html" class="external-link">max_time</a></span><span class="op">(</span><span class="va">adm_2km</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="co"># constant rate in time domain</span></span>
<span>  <span class="fu"><a href="https://mindthegap-erc.github.io/admtools/reference/time_to_strat.html" class="external-link">time_to_strat</a></span><span class="op">(</span><span class="va">adm_2km</span>, destructive <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span>                     <span class="co"># transform into depth domain</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span>xlab <span class="op">=</span> <span class="st">"Stratigraphic height [m]"</span>,                           <span class="co"># plot</span></span>
<span>       main <span class="op">=</span> <span class="st">"Fossil abundance 2 km offshore"</span>,</span>
<span>       ylab <span class="op">=</span> <span class="st">"# Fossils"</span>,</span>
<span>       breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fu"><a href="https://mindthegap-erc.github.io/admtools/reference/min_height.html" class="external-link">min_height</a></span><span class="op">(</span><span class="va">adm_2km</span><span class="op">)</span>, to <span class="op">=</span> <span class="fu"><a href="https://mindthegap-erc.github.io/admtools/reference/max_height.html" class="external-link">max_height</a></span><span class="op">(</span><span class="va">adm_2km</span><span class="op">)</span>, length.out <span class="op">=</span> <span class="fl">20</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="event_data_files/figure-html/unnamed-chunk-5-1.png" class="r-plt" alt="stratigraphic expression of fossil occurrences 2 km from shore." width="700"></p>
<p>Note the option <code>destructive = TRUE</code> in
<code>time_to_strat</code>. This is because we assume specimens that
lived during a hiatus are destroyed.</p>
<p>Assuming the same rate of fossil specimens, we get a very different
pattern 12 km from shore:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/p3.html">p3</a></span><span class="op">(</span>rate <span class="op">=</span> <span class="fl">200</span>, from <span class="op">=</span> <span class="fu"><a href="https://mindthegap-erc.github.io/admtools/reference/min_time.html" class="external-link">min_time</a></span><span class="op">(</span><span class="va">adm_12km</span><span class="op">)</span>, to <span class="op">=</span> <span class="fu"><a href="https://mindthegap-erc.github.io/admtools/reference/max_time.html" class="external-link">max_time</a></span><span class="op">(</span><span class="va">adm_12km</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span>  <span class="co"># same rate as 2 km from shore</span></span>
<span>  <span class="fu"><a href="https://mindthegap-erc.github.io/admtools/reference/time_to_strat.html" class="external-link">time_to_strat</a></span><span class="op">(</span><span class="va">adm_12km</span>, destructive <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span>                       <span class="co"># use different adm for transformation</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span>xlab <span class="op">=</span> <span class="st">"Stratigraphic height [m]"</span>,                              <span class="co"># plot histogram</span></span>
<span>       main <span class="op">=</span> <span class="st">"Fossil abundance 12 km offshore"</span>,</span>
<span>       ylab <span class="op">=</span> <span class="st">"# Fossils"</span>,</span>
<span>       breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fu"><a href="https://mindthegap-erc.github.io/admtools/reference/min_height.html" class="external-link">min_height</a></span><span class="op">(</span><span class="va">adm_12km</span><span class="op">)</span>, to <span class="op">=</span> <span class="fu"><a href="https://mindthegap-erc.github.io/admtools/reference/max_height.html" class="external-link">max_height</a></span><span class="op">(</span><span class="va">adm_12km</span><span class="op">)</span>, length.out <span class="op">=</span> <span class="fl">20</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="event_data_files/figure-html/unnamed-chunk-6-1.png" class="r-plt" alt="stratigraphic occurrence of fossil occurrences 12 km from shore." width="700"></p>
<p>Not only is the section much shorter (not even 20 m), but there are 2
distinct peaks at the bottom of the section and around 13 m. Comparing
with the age-depth model shows that these locations correspond to times
of extreme stratigraphic condensation (low sedimentation rates,
indicated by a near-horizontal age-depth model). As a result, more time
is represented per stratigraphic increment, leading to fossil
accumulations (<a href="#References">Hohmann 2021</a>).</p>
<p><strong>Task:</strong> How does fossil abundance change along an
onshore-offshore gradient when you assume the same rate of fossil
occurrences in the time domain? Are there intervals where you can not
recover spikes in fossil abundance, i.e. an increase in rate? How are
these intervals linked to the external drivers of the platform
architecture such as sea level and water depth?</p>
</div>
<div class="section level3">
<h3 id="firstlast-occurrences-of-common-taxa">First/Last occurrences of common taxa<a class="anchor" aria-label="anchor" href="#firstlast-occurrences-of-common-taxa"></a>
</h3>
<p>In the fossil record, we can not directly observe origination and
extinction rates of taxa, but only their first and last occurrences.
This type of event data can directly be transformed using
<code>time_to_strat</code> when we assume taxa are very common. This
assumption will be explored further below.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/p3.html">p3</a></span><span class="op">(</span>rate <span class="op">=</span> <span class="fl">200</span>, from <span class="op">=</span> <span class="fu"><a href="https://mindthegap-erc.github.io/admtools/reference/min_time.html" class="external-link">min_time</a></span><span class="op">(</span><span class="va">adm_2km</span><span class="op">)</span>, to <span class="op">=</span> <span class="fu"><a href="https://mindthegap-erc.github.io/admtools/reference/max_time.html" class="external-link">max_time</a></span><span class="op">(</span><span class="va">adm_2km</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="co"># constant rate of last occ</span></span>
<span>  <span class="fu"><a href="https://mindthegap-erc.github.io/admtools/reference/time_to_strat.html" class="external-link">time_to_strat</a></span><span class="op">(</span><span class="va">adm_2km</span>, destructive <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">|&gt;</span>                    <span class="co"># non-destructive transformation!</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span>xlab <span class="op">=</span> <span class="st">"Stratigraphic height [m]"</span>,                           <span class="co"># plot histogram</span></span>
<span>       main <span class="op">=</span> <span class="st">"Last occurrences 2 km offshore"</span>,</span>
<span>       ylab <span class="op">=</span> <span class="st">"# Last occurrences"</span>,</span>
<span>       breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fu"><a href="https://mindthegap-erc.github.io/admtools/reference/min_height.html" class="external-link">min_height</a></span><span class="op">(</span><span class="va">adm_2km</span><span class="op">)</span>, to <span class="op">=</span> <span class="fu"><a href="https://mindthegap-erc.github.io/admtools/reference/max_height.html" class="external-link">max_height</a></span><span class="op">(</span><span class="va">adm_2km</span><span class="op">)</span>, length.out <span class="op">=</span> <span class="fl">20</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="event_data_files/figure-html/unnamed-chunk-7-1.png" class="r-plt" alt="stratigraphic expression of last occurrences 2 km from shore." width="700"></p>
<p>This would be the pattern of last occurrences in the section 2 km
offshore when the rate of last occurrences is constant in the time
domain! The peaks coincide with the hiatuses, as the last occurrences of
the species that disappear during the hiatus cluster at the hiatus
surface (<a href="#References">Holland and Patzkowsky 2015</a>). Note
here that we used the option <code>destructive = FALSE</code> for
<code>time_to_strat</code> to make sure last occurrences that happen
during a hiatus appear at the hiatus surface. This is why the assumption
of abundant taxa is important: If taxa are rare, their last occurrence
does not match their actual time of extinction (Signor-Lipps effect, <a href="#References">Signor and Lipps 1982</a>), and their last
occurrences would be found below the hiatus surface. We explore the role
of abundance on the location of last occurrences further in the section
on <a href="#Range-offset">range offset</a>.</p>
<p>The patter 12 km offshore is very different:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/p3.html">p3</a></span><span class="op">(</span>rate <span class="op">=</span> <span class="fl">200</span>, from <span class="op">=</span> <span class="fu"><a href="https://mindthegap-erc.github.io/admtools/reference/min_time.html" class="external-link">min_time</a></span><span class="op">(</span><span class="va">adm_12km</span><span class="op">)</span>, to <span class="op">=</span> <span class="fu"><a href="https://mindthegap-erc.github.io/admtools/reference/max_time.html" class="external-link">max_time</a></span><span class="op">(</span><span class="va">adm_12km</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://mindthegap-erc.github.io/admtools/reference/time_to_strat.html" class="external-link">time_to_strat</a></span><span class="op">(</span><span class="va">adm_12km</span>, destructive <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span>xlab <span class="op">=</span> <span class="st">"Stratigraphic height [m]"</span>,</span>
<span>       main <span class="op">=</span> <span class="st">"Last occurrences 12 km offshore"</span>,</span>
<span>       ylab <span class="op">=</span> <span class="st">"# Last occurrences"</span>,</span>
<span>       breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fu"><a href="https://mindthegap-erc.github.io/admtools/reference/min_height.html" class="external-link">min_height</a></span><span class="op">(</span><span class="va">adm_12km</span><span class="op">)</span>, to <span class="op">=</span> <span class="fu"><a href="https://mindthegap-erc.github.io/admtools/reference/max_height.html" class="external-link">max_height</a></span><span class="op">(</span><span class="va">adm_12km</span><span class="op">)</span>, length.out <span class="op">=</span> <span class="fl">20</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="event_data_files/figure-html/unnamed-chunk-8-1.png" class="r-plt" alt="stratigraphic expression of last occurrences 12 km from shore." width="700"></p>
<p>It almost perfectly matches the pattern of fossil abundance. This is
because the offshore section is much more dominated by condensation
(which influences both fossil abundance and first/last occurrences
equally), while the onshore section is dominated by hiatuses (which
affect first/last occurrences). This shows that it is important to
understand how “event” type data is affected by hiatuses: is it
preserved, or is it destroyed?</p>
<p>Naturally, the same modeling pipeline is valid for first occurrences
of common taxa.</p>
<p>The assumption of common taxa can be relaxed using the wrapper
<code>last_occ</code>, which provides the position and timing of the
last occurrence or a taxon as a function of taxon abundance, ecology,
taphonomy, and stratigraphy.</p>
<p><strong>Task:</strong> How does the pattern of last occurrences
change across an onshore-offshore gradient? If you observed a spike in
last occurrences in one of the section, for what stratigraphic
information do you need to look to exclude the possibility that the
spike is a stratigraphic artifact?</p>
</div>
<div class="section level3">
<h3 id="Range-offset">Range offset<a class="anchor" aria-label="anchor" href="#Range-offset"></a>
</h3>
<p>Here we explore the idea of <em>range offset</em>, which is the
offset between the last occurrence of a taxon and its actual time of
extinction (<a href="#References">Holland and Patzkowsky 1999</a>).</p>
<p>First, we model all occurrences of the taxon up to its extinction in
the time domain, and save it in a variable:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">t_ext</span> <span class="op">=</span> <span class="fl">1.5</span> <span class="co"># time of "true" extinction</span></span>
<span><span class="va">r</span> <span class="op">=</span> <span class="fl">30</span>      <span class="co"># rate of fossil occurrences</span></span>
<span><span class="co"># simulate rate fossil occurrences of taxon </span></span>
<span><span class="va">f_occ</span> <span class="op">=</span> <span class="fu"><a href="../reference/p3.html">p3</a></span><span class="op">(</span><span class="va">r</span>, from <span class="op">=</span> <span class="fu"><a href="https://mindthegap-erc.github.io/admtools/reference/min_time.html" class="external-link">min_time</a></span><span class="op">(</span><span class="va">adm_2km</span><span class="op">)</span>, to <span class="op">=</span> <span class="va">t_ext</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">f_occ</span>,</span>
<span>     xlab <span class="op">=</span> <span class="st">"Time [Myr]"</span>,</span>
<span>     ylab <span class="op">=</span> <span class="st">"# Fossils"</span>,</span>
<span>     main <span class="op">=</span> <span class="st">"Fossil abundance"</span>,</span>
<span>     breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fu"><a href="https://mindthegap-erc.github.io/admtools/reference/min_time.html" class="external-link">min_time</a></span><span class="op">(</span><span class="va">adm_2km</span><span class="op">)</span>, to <span class="op">=</span> <span class="fu"><a href="https://mindthegap-erc.github.io/admtools/reference/max_time.html" class="external-link">max_time</a></span><span class="op">(</span><span class="va">adm_2km</span><span class="op">)</span>, length.out <span class="op">=</span> <span class="fl">20</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="event_data_files/figure-html/unnamed-chunk-9-1.png" class="r-plt" alt="fossil occurrences in the time domain." width="700"></p>
<p>Then we can determine the stratigraphic position of the highest
preserved fossil:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">highest_occ</span> <span class="op">=</span> <span class="va">f_occ</span> <span class="op">|&gt;</span>                          <span class="co"># take fossil occ. in time domain</span></span>
<span>  <span class="fu"><a href="https://mindthegap-erc.github.io/admtools/reference/time_to_strat.html" class="external-link">time_to_strat</a></span><span class="op">(</span><span class="va">adm_2km</span>, destructive <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="co"># transform into stratigraphic domain, destroying fossils that coincide with hiatuses</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span>na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>                             <span class="co"># find highest preserved fossil (destroyed fossils are NA)</span></span></code></pre></div>
<p>Now we can determine two types of range offset, stratigraphic range
offset and temporal range offset. Stratigraphic range offset distance
(length dimension, SI units meter) between the position of the last
preserved fossil and the stratigraphic position where the taxon actually
goes extinct:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">h_true_ext</span> <span class="op">=</span> <span class="va">t_ext</span> <span class="op">|&gt;</span>                           <span class="co"># stratigraphic position of "true" extinction</span></span>
<span>  <span class="fu"><a href="https://mindthegap-erc.github.io/admtools/reference/time_to_strat.html" class="external-link">time_to_strat</a></span><span class="op">(</span><span class="va">adm_2km</span>, destructive <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> </span>
<span></span>
<span><span class="co"># distance between last occurrence of taxon and location where they actually go extinct</span></span>
<span><span class="va">strat_range_offset_m</span> <span class="op">=</span> <span class="va">h_true_ext</span> <span class="op">-</span> <span class="va">highest_occ</span></span></code></pre></div>
<p>In this example, the stratigraphic range offset is 0.0895 meters.</p>
<p>The temporal range offset (time dimension, SI units seconds and
derived units such as years) is the difference in time between the age
of the last occurrence and the actual time of extinction:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">t_last_occ</span> <span class="op">=</span> <span class="va">highest_occ</span> <span class="op">|&gt;</span> <span class="co"># time when last preserved fossil lived</span></span>
<span>  <span class="fu"><a href="https://mindthegap-erc.github.io/admtools/reference/strat_to_time.html" class="external-link">strat_to_time</a></span><span class="op">(</span><span class="va">adm_2km</span><span class="op">)</span></span>
<span><span class="co"># time offset between true extinction and time when last fossil lived.</span></span>
<span><span class="va">time_range_offset_myr</span> <span class="op">=</span> <span class="va">t_ext</span> <span class="op">-</span> <span class="va">t_last_occ</span></span></code></pre></div>
<p>In this example, the temporal range offset is 0.125 Myr years.</p>
<p>The wrapper <code>range_offset</code> allows to determine both
stratigraphic and temporal range offset as a function of ecology,
taphonomy, taxon abundance, and stratigraphy.</p>
<p><strong>Task:</strong> How does the (temporal and stratigraphic)
range offset change with the rate parameter? For which rate values are
taxa abundant enough to make the Signor-Lipps effect negligible
(i.e. the stratigraphic range offset is sufficiently small)? How do the
results vary with (1) different times of “true” extinction within a
fixed section and (2) across the onshore-offshore gradient?</p>
</div>
</div>
<div class="section level2">
<h2 id="niche-modeling">Niche modeling<a class="anchor" aria-label="anchor" href="#niche-modeling"></a>
</h2>
<p>So far, we have only examined the effects of stratigraphic
distortions (i.e., gaps and changes in sedimentation rates) on event
type data. Here, we increase the complexity of the pipeline by
incorporating niche modeling. For this, we need two components:</p>
<ul>
<li><p>a niche definition that describes a taxons’ optimum value along
an environmental gradient (cline), i.e. where is it the most abundant,
and its tolerance along this gradient</p></li>
<li><p>information on how that gradient changes with time</p></li>
</ul>
<p>In this example we focus on <em>water depth</em> as gradient. The
general modeling framework works for any type of cline, see the
“advanced functionality” vignette for details.</p>
<p>First, we define a function that determines how water depth (our
gradient) changes with time:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">t</span> <span class="op">=</span> <span class="va">scenarioA</span><span class="op">$</span><span class="va">t_myr</span>           <span class="co"># time steps of the model</span></span>
<span><span class="va">wd</span> <span class="op">=</span> <span class="va">scenarioA</span><span class="op">$</span><span class="va">wd_m</span><span class="op">[</span>,<span class="st">"2km"</span><span class="op">]</span>   <span class="co"># water depth 2 km offshore at model time steps</span></span>
<span><span class="va">gc</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/approxfun.html" class="external-link">approxfun</a></span><span class="op">(</span><span class="va">t</span>, <span class="va">wd</span><span class="op">)</span>         <span class="co"># define function that defines how the gradient changes with time (gc = *G*radient *C*hange)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">t</span>, <span class="fu"><a href="https://rdrr.io/r/base/gc.html" class="external-link">gc</a></span><span class="op">(</span><span class="va">t</span><span class="op">)</span>, </span>
<span>     type <span class="op">=</span> <span class="st">"l"</span>, </span>
<span>     xlab <span class="op">=</span> <span class="st">"Time [Myr]"</span>,</span>
<span>     ylab <span class="op">=</span> <span class="st">"Water depth [m]"</span>,</span>
<span>     main <span class="op">=</span> <span class="st">"Water depth 2 km offshore"</span><span class="op">)</span></span></code></pre></div>
<p><img src="event_data_files/figure-html/unnamed-chunk-13-1.png" class="r-plt" alt="water depth 2 km from shore in scenario A." width="700"></p>
<p>Next, we define the niche. This is done using a function that takes
water depth (our gradient) as input, and returns numbers between 0 and
1. A 1 corresponds to the taxons’ environmental optimum, and a 0
reflects that it is completely outside of its niche. Values between 0
and 1 are are interpreted as observation or collection probabilities. If
a specimen is present at a given time, the collection probability is the
probability to observe it at the specified gradient.</p>
<p>For our example, we use the helper function <code>snd_niche</code>
(<em>snd</em> standing for “scaled normal distribution”) to define a
niche. The collection probability in this model follows the shape of a
bell curve with a peak at the environmental optimum, and a width
specified by the <code>tol</code> parameter. This is identical to the
<em>probability of collection</em> model by <a href="#References">Holland and Patzkowsky (1999)</a>. See the “advanced
functionality” vignette for details how to construct other niche
definitions, <code><a href="../reference/bounded_niche.html">?bounded_niche</a></code> for another template niche
mode, and <code><a href="../reference/discrete_niche.html">?discrete_niche</a></code> for defining niches based on
discrete categories.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_niche</span> <span class="op">=</span> <span class="fu"><a href="../reference/snd_niche.html">snd_niche</a></span><span class="op">(</span>opt <span class="op">=</span> <span class="fl">10</span>,       <span class="co"># preferred water depth </span></span>
<span>                     tol <span class="op">=</span> <span class="fl">5</span>,        <span class="co"># tolerance to water depth fluctuations</span></span>
<span>                     cutoff_val <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="co"># cut off negative values - the taxon does not survive on land</span></span>
<span><span class="va">x</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span>, <span class="fl">30</span>, by <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">x</span>, <span class="fu">my_niche</span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,</span>
<span>     type <span class="op">=</span> <span class="st">"l"</span>,</span>
<span>     xlab <span class="op">=</span> <span class="st">"Water depth [m]"</span>,</span>
<span>     ylab <span class="op">=</span> <span class="st">"Collection probability"</span>,</span>
<span>     main <span class="op">=</span> <span class="st">"Collection probability of taxon"</span><span class="op">)</span></span></code></pre></div>
<p><img src="event_data_files/figure-html/unnamed-chunk-14-1.png" class="r-plt" alt="collection probability of a taxon along water depth." width="700"></p>
<p>The taxon we are modeling has its environmental niche optimum in 10 m
water depth (<code>opt = 10</code>), is moderately tolerant to
fluctuations in water depth (<code>tol = 5</code>) and does not survive
on land (<code>cutoff_val = 0</code>).</p>
<p>With the niche and the change in gradient defined, we can use
<code>apply_niche</code> for niche modeling.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/p3.html">p3</a></span><span class="op">(</span>rate <span class="op">=</span> <span class="fl">300</span>, from <span class="op">=</span> <span class="fu"><a href="https://mindthegap-erc.github.io/admtools/reference/min_time.html" class="external-link">min_time</a></span><span class="op">(</span><span class="va">adm_2km</span><span class="op">)</span>, to <span class="op">=</span> <span class="fu"><a href="https://mindthegap-erc.github.io/admtools/reference/max_time.html" class="external-link">max_time</a></span><span class="op">(</span><span class="va">adm_2km</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="co"># model occurrences of taxon based on a constant rate</span></span>
<span>  <span class="fu"><a href="../reference/apply_niche.html">apply_niche</a></span><span class="op">(</span>niche_def <span class="op">=</span> <span class="va">my_niche</span>, gc <span class="op">=</span> <span class="va">gc</span><span class="op">)</span> <span class="op">|&gt;</span>                     <span class="co"># apply the niche model</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span>xlab <span class="op">=</span> <span class="st">"Time [Myr]"</span>,</span>
<span>       main <span class="op">=</span> <span class="st">"Fossil abundance"</span>,</span>
<span>       ylab <span class="op">=</span> <span class="st">"# Fossils"</span>,</span>
<span>       breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fu"><a href="https://mindthegap-erc.github.io/admtools/reference/min_time.html" class="external-link">min_time</a></span><span class="op">(</span><span class="va">adm_2km</span><span class="op">)</span>, to <span class="op">=</span> <span class="fu"><a href="https://mindthegap-erc.github.io/admtools/reference/max_time.html" class="external-link">max_time</a></span><span class="op">(</span><span class="va">adm_2km</span><span class="op">)</span>, length.out <span class="op">=</span> <span class="fl">40</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="event_data_files/figure-html/unnamed-chunk-15-1.png" class="r-plt" alt="fossil abundance in the time domain, with incorporation of niche modeling." width="700"></p>
<p>Here you can see that the taxon only occurs at times where the water
depth is favorable for it. Around 2 Myr, the water depth is too shallow,
and the fossil abundance is reduced.</p>
<p>With the basic niche modeling done, we can incorporate it into our
modeling pipeline to examine the joint effects of stratigraphic
distortion by age-depth models and niche preferences.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/p3.html">p3</a></span><span class="op">(</span>rate <span class="op">=</span> <span class="fl">300</span>, from <span class="op">=</span> <span class="fu"><a href="https://mindthegap-erc.github.io/admtools/reference/min_time.html" class="external-link">min_time</a></span><span class="op">(</span><span class="va">adm_2km</span><span class="op">)</span>, to <span class="op">=</span> <span class="fu"><a href="https://mindthegap-erc.github.io/admtools/reference/max_time.html" class="external-link">max_time</a></span><span class="op">(</span><span class="va">adm_2km</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="co"># model occurrences based on constant rate</span></span>
<span>  <span class="fu"><a href="../reference/apply_niche.html">apply_niche</a></span><span class="op">(</span>niche_def <span class="op">=</span> <span class="va">my_niche</span>, gc <span class="op">=</span> <span class="va">gc</span><span class="op">)</span> <span class="op">|&gt;</span>                     <span class="co"># apply niche model</span></span>
<span>  <span class="fu"><a href="https://mindthegap-erc.github.io/admtools/reference/time_to_strat.html" class="external-link">time_to_strat</a></span><span class="op">(</span><span class="va">adm_2km</span>, destructive <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span>                     <span class="co"># transform into strat. domain, destroy fossils that coincide with hiatuses </span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span>xlab <span class="op">=</span> <span class="st">"Stratigraphic height [m]"</span>,                           <span class="co"># plot results</span></span>
<span>       main <span class="op">=</span> <span class="st">"Fossil abundance 2 km from shore"</span>,</span>
<span>       ylab <span class="op">=</span> <span class="st">"# Fossils"</span>,</span>
<span>       breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fu"><a href="https://mindthegap-erc.github.io/admtools/reference/min_height.html" class="external-link">min_height</a></span><span class="op">(</span><span class="va">adm_2km</span><span class="op">)</span>, to <span class="op">=</span> <span class="fu"><a href="https://mindthegap-erc.github.io/admtools/reference/max_height.html" class="external-link">max_height</a></span><span class="op">(</span><span class="va">adm_2km</span><span class="op">)</span>, length.out <span class="op">=</span> <span class="fl">40</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="event_data_files/figure-html/unnamed-chunk-16-1.png" class="r-plt" alt="fossil abundance in the stratigraphic domain, with incorporation of niche modeling." width="700"></p>
<p>You can see a general decrease in fossil abundance, but in contrast
to the time domain, no prolonged intervals without the fossil are
visible. This is because the gaps in fossil abundance in the time domain
coincide with hiatuses, and will thus not be visible in the
stratigraphic domain. The decrease in fossil abundance seen here is
because the carbonate platform stratigraphy used here is characterized
by continuous growth of carbonates, which fill in the available
accommodation space, thus reducing the water depth over time. This is a
typical scenario in many carbonate platforms, but other scenarios are
possible.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"t"</span> <span class="op">=</span> <span class="va">t</span>, <span class="st">"y"</span> <span class="op">=</span> <span class="va">wd</span><span class="op">)</span> <span class="op">|&gt;</span>    <span class="co"># create list with time - water depth information</span></span>
<span>  <span class="fu"><a href="https://mindthegap-erc.github.io/admtools/reference/time_to_strat.html" class="external-link">time_to_strat</a></span><span class="op">(</span><span class="va">adm_2km</span><span class="op">)</span> <span class="op">|&gt;</span>   <span class="co"># transform into the strat. domain</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span>orientation <span class="op">=</span> <span class="st">"lr"</span>,    <span class="co"># plot water depth information in the stratigraphic domain</span></span>
<span>       type <span class="op">=</span> <span class="st">"l"</span>,</span>
<span>       xlab <span class="op">=</span> <span class="st">"Stratigraphic position [m]"</span>,</span>
<span>       ylab <span class="op">=</span> <span class="st">"Water depth [m]"</span>,</span>
<span>       main <span class="op">=</span> <span class="st">"Water depth in section 2 km from shore"</span><span class="op">)</span></span></code></pre></div>
<p><img src="event_data_files/figure-html/unnamed-chunk-17-1.png" class="r-plt" alt="water depth 2 km from shore expressed in the stratigraphic domain." width="700"></p>
<p><strong>Task:</strong> How does the effect of niche preference change
across the onshore-offshore gradient? There is a dependency between
stratigraphic effects (gaps, changes in sedimentation rate) and water
depth/eustatic sea level. Does linking ecology to water depth strengthen
or weaken the effects of stratigraphic distortions examined in section
<a href="#Stratigraphic-distortions">“stratigraphic distortions of event
type data”</a>?</p>
</div>
<div class="section level2">
<h2 id="taphonomic-effects">Taphonomic effects<a class="anchor" aria-label="anchor" href="#taphonomic-effects"></a>
</h2>
<p>The modeling of taphonomic effects follows the same principles as
niche modeling, with <code>apply_niche</code> being replaced by
<code>apply_taphonomy</code>. This function takes two key arguments: *
<code>pres_potential</code>: A function assigning a preservation
potential to taphonomic conditions * <code>ctc</code>: A function
describing <strong>c</strong>hange in <strong>t</strong>aphonomic
<strong>c</strong>onditions with time.</p>
<p>As with niche modeling, taphonomic effects can be incorporated in the
stratigraphic and the time domain. The wrappers <code>last_occ</code>
and <code>range_offset</code> incorporate taphonomic effects.</p>
</div>
<div class="section level2">
<h2 id="further-reading">Further reading<a class="anchor" aria-label="anchor" href="#further-reading"></a>
</h2>
<p>Go to</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/vignette.html" class="external-link">vignette</a></span><span class="op">(</span><span class="st">"phenotypic_evolution"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/vignette.html" class="external-link">vignette</a></span><span class="op">(</span><span class="st">"paleoTS_functionality"</span><span class="op">)</span></span></code></pre></div>
<p>for details on how to model stratigraphic paleobiology of phenotypic
evolution and integrate it with the <code>paleoTS</code> and
<code>evoTS</code> packages (<a href="#References">Hunt 2006, Voje
2023</a>), or explore the vignette online under <a href="https://mindthegap-erc.github.io/StratPal/articles/phenotypic_evolution.html">mindthegap-erc.github.io/StratPal/articles/phenotypic_evolution</a>.</p>
<p>See also</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/vignette.html" class="external-link">vignette</a></span><span class="op">(</span><span class="st">"advanced_functionality"</span><span class="op">)</span></span></code></pre></div>
<p>for details on how to expand on the modeling pipelines described
here, or explore the vignette online under <a href="https://mindthegap-erc.github.io/StratPal/articles/advanced_functionality.html">mindthegap-erc.github.io/StratPal/articles/advanced_functionality</a>.</p>
</div>
<div class="section level2">
<h2 id="References">References<a class="anchor" aria-label="anchor" href="#References"></a>
</h2>
<ul>
<li><p>Hohmann, Niklas. 2021. “Incorporating information on varying
sedimentation rates into paleontological analyses.” PALAIOS. <a href="https://doi.org/10.2110/palo.2020.038" class="external-link uri">https://doi.org/10.2110/palo.2020.038</a>.</p></li>
<li><p>Hohmann, Niklas; Koelewijn, Joël R.; Burgess, Peter; Jarochowska,
Emilia. 2024. “Identification of the mode of evolution in incomplete
carbonate successions.” BMC Ecology and Evolution 24, 113. <a href="https://doi.org/10.1186/s12862-024-02287-2" class="external-link uri">https://doi.org/10.1186/s12862-024-02287-2</a>.</p></li>
<li><p>Holland, Steven M. and Patzkowsky, Mark E. 1999. “Models for
simulating the fossil record.” Geology. <a href="https://doi.org/10.1130/0091-7613(1999)027%3C0491:MFSTFR%3E2.3.CO;2" class="external-link uri">https://doi.org/10.1130/0091-7613(1999)027%3C0491:MFSTFR%3E2.3.CO;2</a></p></li>
<li><p>Holland, Steven M. and Patzkowsky, Mark E. 2015. “The
stratigraphy of mass extinction.” Palaeontology. <a href="https://doi.org/10.1111/pala.12188" class="external-link uri">https://doi.org/10.1111/pala.12188</a>.</p></li>
<li><p>Hunt, Gene. 2006. “Fitting and Comparing Models of Phyletic
Evolution: Random Walks and Beyond.” Paleobiology. <a href="https://doi.org/10.1666/05070.1" class="external-link uri">https://doi.org/10.1666/05070.1</a>.</p></li>
<li><p>Signor, Philip W.; Lipps, Jere H. 1982. “Sampling bias, gradual
extinction patterns and catastrophes in the fossil record.” Geological
Society of America Special Paper 190.</p></li>
<li><p>Voje, Kjetil L. 2023. “Fitting and Evaluating Univariate and
Multivariate Models of Within-Lineage Evolution.” Paleobiology. <a href="https://doi.org/10.1017/pab.2023.10" class="external-link uri">https://doi.org/10.1017/pab.2023.10</a>.</p></li>
</ul>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Niklas Hohmann.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
