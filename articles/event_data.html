<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Stratigraphic Paleobiology for Event Data • StratPal</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Stratigraphic Paleobiology for Event Data">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">StratPal</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/StratPal.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/event_data.html">Stratigraphic Paleobiology for Event Data</a></li>
    <li><a class="dropdown-item" href="../articles/phenotypic_evolution.html">Stratigraphic Paleobiology for Phenotypic Evolution</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/MindTheGap-ERC/StratPal/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Stratigraphic Paleobiology for Event Data</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/MindTheGap-ERC/StratPal/blob/main/vignettes/event_data.Rmd" class="external-link"><code>vignettes/event_data.Rmd</code></a></small>
      <div class="d-none name"><code>event_data.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://mindthegap-erc.github.io/StratPal/">StratPal</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/MindTheGap-ERC/admtools" class="external-link">admtools</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This vignette provides an introduction to stratigraphic paleobiology
applied to fossil occurrences and first/last taxon occurrences.</p>
</div>
<div class="section level2">
<h2 id="modeling-fossil-occurrences-and-firstlast-fossil-occurrences">Modeling fossil occurrences and first/last fossil occurrences<a class="anchor" aria-label="anchor" href="#modeling-fossil-occurrences-and-firstlast-fossil-occurrences"></a>
</h2>
<p>Fossil occurrences and first/last occurrences can be considered
distinct events that occur at specific points in time or stratigraphic
position. We model them as point processes. In the <code>StratPal</code>
package, we provide two functions to simulate point processes:</p>
<ul>
<li><p><code>p3</code>, short for Poisson point process, to simulate
events that occur at a constant rate</p></li>
<li><p><code>p3_var_rate</code> for variable rate Poisson point
processes to simulate events that occur at variable rates
(e.g. extinction events etc.)</p></li>
</ul>
<p>The usage of <code>p3</code> is straightforward:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># simulate fossil occurrences over one Myr with an average of 8 occurrences per Myr</span></span>
<span><span class="fu"><a href="../reference/p3.html">p3</a></span><span class="op">(</span>rate <span class="op">=</span> <span class="fl">8</span>, from <span class="op">=</span> <span class="fl">0</span>, to <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span>main <span class="op">=</span> <span class="st">"Fossil occurrences"</span>,</span>
<span>       xlab <span class="op">=</span> <span class="st">"Time [Myr]"</span><span class="op">)</span></span></code></pre></div>
<p><img src="event_data_files/figure-html/unnamed-chunk-2-1.png" width="700"></p>
<p>For <code>p3_var_rate</code>, you can pass either a function that
specifies the rate:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># return 100 occurrences by setting n parameter</span></span>
<span><span class="fu"><a href="../reference/p3_var_rate.html">p3_var_rate</a></span><span class="op">(</span><span class="va">sin</span>, from <span class="op">=</span> <span class="fl">0</span>, to <span class="op">=</span> <span class="fl">9</span>, n <span class="op">=</span> <span class="fl">100</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span>xlab <span class="op">=</span> <span class="st">"Time [Myr]"</span>, main <span class="op">=</span> <span class="st">"Fossil occurrences"</span><span class="op">)</span></span></code></pre></div>
<p><img src="event_data_files/figure-html/unnamed-chunk-3-1.png" width="700"></p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># note that negative rates (where sin &lt; 0) are ignored</span></span></code></pre></div>
<p>Alternatively, you can pass it two vectors <code>x</code> and
<code>y</code>. The rate is then determined by linear interpolation
between these vectors. This is equivalent to using the function
<code>approxfun(x,y)</code></p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># decline in fossil occurrences from 50 to 0 over 1 Myr</span></span>
<span><span class="fu"><a href="../reference/p3_var_rate.html">p3_var_rate</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">50</span>, <span class="fl">0</span><span class="op">)</span>, from <span class="op">=</span> <span class="fl">0</span>, to <span class="op">=</span> <span class="fl">1</span>, f_max <span class="op">=</span> <span class="fl">50</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span>xlab <span class="op">=</span> <span class="st">"Time [Myr]"</span>, main <span class="op">=</span> <span class="st">"Fossil occurrences"</span><span class="op">)</span></span></code></pre></div>
<p><img src="event_data_files/figure-html/unnamed-chunk-4-1.png" width="700"></p>
<p>Note that it is only a matter of interpretation whether the “events”
produced by <code>p3</code> and <code>p3_var_rate</code> are fossil
occurrences or first/last occurrences. The conceptual framework holds
nonetheless.</p>
</div>
<div class="section level2">
<h2 id="age-depth-models">Age-depth models<a class="anchor" aria-label="anchor" href="#age-depth-models"></a>
</h2>
<p>Throughout the examples, we use the same two age-depth model, which
is from 2 km and 12 km offshore in scenario A. We define them</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># define ADM 2 km from shore</span></span>
<span><span class="va">adm_2km</span> <span class="op">=</span> <span class="fu"><a href="https://mindthegap-erc.github.io/admtools/reference/tp_to_adm.html" class="external-link">tp_to_adm</a></span><span class="op">(</span>t <span class="op">=</span> <span class="va">scenarioA</span><span class="op">$</span><span class="va">t_myr</span>,</span>
<span>                h <span class="op">=</span> <span class="va">scenarioA</span><span class="op">$</span><span class="va">h_m</span><span class="op">[</span>,<span class="st">"2km"</span><span class="op">]</span>,</span>
<span>                T_unit <span class="op">=</span> <span class="st">"Myr"</span>,</span>
<span>                L_unit <span class="op">=</span> <span class="st">"m"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">adm_12km</span> <span class="op">=</span> <span class="fu"><a href="https://mindthegap-erc.github.io/admtools/reference/tp_to_adm.html" class="external-link">tp_to_adm</a></span><span class="op">(</span>t <span class="op">=</span> <span class="va">scenarioA</span><span class="op">$</span><span class="va">t_myr</span>,</span>
<span>                h <span class="op">=</span> <span class="va">scenarioA</span><span class="op">$</span><span class="va">h_m</span><span class="op">[</span>,<span class="st">"12km"</span><span class="op">]</span>,</span>
<span>                T_unit <span class="op">=</span> <span class="st">"Myr"</span>,</span>
<span>                L_unit <span class="op">=</span> <span class="st">"m"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># plot age-depth model</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">adm_2km</span>,</span>
<span>     lwd_acc <span class="op">=</span> <span class="fl">2</span>,   <span class="co"># plot thicker lines for accumulative intervals (lwd = line width)</span></span>
<span>     lty_destr <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="co"># don't plot destructive intervals (lty = line type)</span></span>
<span><span class="fu"><a href="https://mindthegap-erc.github.io/admtools/reference/T_axis_lab.html" class="external-link">T_axis_lab</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># add time axis label</span></span>
<span><span class="fu"><a href="https://mindthegap-erc.github.io/admtools/reference/L_axis_lab.html" class="external-link">L_axis_lab</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># add length axis label</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">adm_12km</span>,</span>
<span>     lwd_acc <span class="op">=</span> <span class="fl">2</span>,   <span class="co"># plot thicker lines for accumulative intervals (lwd = line width)</span></span>
<span>     lty_destr <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="co"># don't plot destructive intervals (lty = line type)</span></span>
<span><span class="fu"><a href="https://mindthegap-erc.github.io/admtools/reference/T_axis_lab.html" class="external-link">T_axis_lab</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># add time axis label</span></span>
<span><span class="fu"><a href="https://mindthegap-erc.github.io/admtools/reference/L_axis_lab.html" class="external-link">L_axis_lab</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># add length axis label</span></span></code></pre></div>
<p><img src="event_data_files/figure-html/figures-side-1.png" width="50%" style="display: block; margin: auto auto auto 0;"><img src="event_data_files/figure-html/figures-side-2.png" width="50%" style="display: block; margin: auto auto auto 0;"></p>
</div>
<div class="section level2">
<h2 id="stratigraphic-distortions-of-event-type-data">Stratigraphic distortions of “event” type data<a class="anchor" aria-label="anchor" href="#stratigraphic-distortions-of-event-type-data"></a>
</h2>
<div class="section level3">
<h3 id="fossil-occurrences">Fossil occurrences<a class="anchor" aria-label="anchor" href="#fossil-occurrences"></a>
</h3>
<p>Any “event” type data can directly transformed using
<code>time_to_strat</code>:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/p3.html">p3</a></span><span class="op">(</span>rate <span class="op">=</span> <span class="fl">200</span>, from <span class="op">=</span> <span class="fu"><a href="https://mindthegap-erc.github.io/admtools/reference/min_time.html" class="external-link">min_time</a></span><span class="op">(</span><span class="va">adm_2km</span><span class="op">)</span>, to <span class="op">=</span> <span class="fu"><a href="https://mindthegap-erc.github.io/admtools/reference/max_time.html" class="external-link">max_time</a></span><span class="op">(</span><span class="va">adm_2km</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://mindthegap-erc.github.io/admtools/reference/time_to_strat.html" class="external-link">time_to_strat</a></span><span class="op">(</span><span class="va">adm_2km</span>, destructive <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span>xlab <span class="op">=</span> <span class="st">"Stratigraphic height [m]"</span>,</span>
<span>       main <span class="op">=</span> <span class="st">"Fossil occurrences 2 km offshore"</span>,</span>
<span>       breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fu"><a href="https://mindthegap-erc.github.io/admtools/reference/min_height.html" class="external-link">min_height</a></span><span class="op">(</span><span class="va">adm_2km</span><span class="op">)</span>, to <span class="op">=</span> <span class="fu"><a href="https://mindthegap-erc.github.io/admtools/reference/max_height.html" class="external-link">max_height</a></span><span class="op">(</span><span class="va">adm_2km</span><span class="op">)</span>, length.out <span class="op">=</span> <span class="fl">20</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="event_data_files/figure-html/unnamed-chunk-5-1.png" width="700"></p>
<p>Note the option <code>destructive = TRUE</code> in
<code>time_to_strat</code>. It makes sure any fossil occurrences that
coincide with a hiatus are destroyed, and do not appear in the
stratigraphic domain.</p>
<p>The pattern looks very different 2 km offshore:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/p3.html">p3</a></span><span class="op">(</span>rate <span class="op">=</span> <span class="fl">200</span>, from <span class="op">=</span> <span class="fu"><a href="https://mindthegap-erc.github.io/admtools/reference/min_time.html" class="external-link">min_time</a></span><span class="op">(</span><span class="va">adm_12km</span><span class="op">)</span>, to <span class="op">=</span> <span class="fu"><a href="https://mindthegap-erc.github.io/admtools/reference/max_time.html" class="external-link">max_time</a></span><span class="op">(</span><span class="va">adm_12km</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://mindthegap-erc.github.io/admtools/reference/time_to_strat.html" class="external-link">time_to_strat</a></span><span class="op">(</span><span class="va">adm_12km</span>, destructive <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span>xlab <span class="op">=</span> <span class="st">"Stratigraphic height [m]"</span>,</span>
<span>       main <span class="op">=</span> <span class="st">"Fossil occurrences 12 km offshore"</span>,</span>
<span>       breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fu"><a href="https://mindthegap-erc.github.io/admtools/reference/min_height.html" class="external-link">min_height</a></span><span class="op">(</span><span class="va">adm_12km</span><span class="op">)</span>, to <span class="op">=</span> <span class="fu"><a href="https://mindthegap-erc.github.io/admtools/reference/max_height.html" class="external-link">max_height</a></span><span class="op">(</span><span class="va">adm_12km</span><span class="op">)</span>, length.out <span class="op">=</span> <span class="fl">20</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="event_data_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
<p>Not only is the section much shorter (not even 20 m), but ther are 2
distinct peaks at the bottom of the section and around 13 m. Comparing
with the age-depth model shows that these locations correspond to times
of extreme stratigraphic condensation (low sedimentation rates,
indicated by a near-horizontal age-depth model). As a result, more time
is represented per stratigraphic increment, leading to accumulations of
fossil occurrences.</p>
</div>
<div class="section level3">
<h3 id="last-occurrences-of-common-taxa">Last occurrences of common taxa<a class="anchor" aria-label="anchor" href="#last-occurrences-of-common-taxa"></a>
</h3>
<p>Last (and first) occurrences can also directly be transformed using
<code>time_to_strat</code> under the condition that the taxa are very
common. This assumption will be explored further below.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/p3.html">p3</a></span><span class="op">(</span>rate <span class="op">=</span> <span class="fl">200</span>, from <span class="op">=</span> <span class="fu"><a href="https://mindthegap-erc.github.io/admtools/reference/min_time.html" class="external-link">min_time</a></span><span class="op">(</span><span class="va">adm_2km</span><span class="op">)</span>, to <span class="op">=</span> <span class="fu"><a href="https://mindthegap-erc.github.io/admtools/reference/max_time.html" class="external-link">max_time</a></span><span class="op">(</span><span class="va">adm_2km</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://mindthegap-erc.github.io/admtools/reference/time_to_strat.html" class="external-link">time_to_strat</a></span><span class="op">(</span><span class="va">adm_2km</span>, destructive <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span>xlab <span class="op">=</span> <span class="st">"Stratigraphic height [m]"</span>,</span>
<span>       main <span class="op">=</span> <span class="st">"Last occurrences 2 km offshore"</span>,</span>
<span>       breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fu"><a href="https://mindthegap-erc.github.io/admtools/reference/min_height.html" class="external-link">min_height</a></span><span class="op">(</span><span class="va">adm_2km</span><span class="op">)</span>, to <span class="op">=</span> <span class="fu"><a href="https://mindthegap-erc.github.io/admtools/reference/max_height.html" class="external-link">max_height</a></span><span class="op">(</span><span class="va">adm_2km</span><span class="op">)</span>, length.out <span class="op">=</span> <span class="fl">20</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="event_data_files/figure-html/unnamed-chunk-7-1.png" width="700"></p>
<p>This would be the pattern of last occurrences in a section 2 km
offshore when the extinction rate is constant! The peaks coincide with
the hiatuses, as the last occurrences of the species that disappear
during the hiatus cluster at the hiatus surface. Note here that we used
the option <code>destructive = FALSE</code> for
<code>time_to_strat</code> to make sure the last occurrences appear at
the location of the hiatus. This is why the assumption of abundant taxa
is important: If taxa are rare, their last occurrence does not match
their actual time of extinction (Signor-Lipps effect), and the last
occurrences can be found further below the hiats.</p>
<p>The patter 12 km offshore is very different:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/p3.html">p3</a></span><span class="op">(</span>rate <span class="op">=</span> <span class="fl">200</span>, from <span class="op">=</span> <span class="fu"><a href="https://mindthegap-erc.github.io/admtools/reference/min_time.html" class="external-link">min_time</a></span><span class="op">(</span><span class="va">adm_12km</span><span class="op">)</span>, to <span class="op">=</span> <span class="fu"><a href="https://mindthegap-erc.github.io/admtools/reference/max_time.html" class="external-link">max_time</a></span><span class="op">(</span><span class="va">adm_12km</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://mindthegap-erc.github.io/admtools/reference/time_to_strat.html" class="external-link">time_to_strat</a></span><span class="op">(</span><span class="va">adm_12km</span>, destructive <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span>xlab <span class="op">=</span> <span class="st">"Stratigraphic height [m]"</span>,</span>
<span>       main <span class="op">=</span> <span class="st">"Last occurrences 12 km offshore"</span>,</span>
<span>       breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fu"><a href="https://mindthegap-erc.github.io/admtools/reference/min_height.html" class="external-link">min_height</a></span><span class="op">(</span><span class="va">adm_12km</span><span class="op">)</span>, to <span class="op">=</span> <span class="fu"><a href="https://mindthegap-erc.github.io/admtools/reference/max_height.html" class="external-link">max_height</a></span><span class="op">(</span><span class="va">adm_12km</span><span class="op">)</span>, length.out <span class="op">=</span> <span class="fl">20</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="event_data_files/figure-html/unnamed-chunk-8-1.png" width="700"></p>
<p>It almost perfectly matches the pattern of the fossil occurrences.
This is because the offshore section is much more dominated by
condensation (which influences both fossil occurrences and first/last
occurrences equally), while the onshore section is dominated by hiatuses
(which affect first/last occurrences). This shows it is important to
understand how “event” type data is affected by hiatuses: is it
preserved, or is it destroyed?</p>
</div>
<div class="section level3">
<h3 id="range-offset">Range offset<a class="anchor" aria-label="anchor" href="#range-offset"></a>
</h3>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">t_ext</span> <span class="op">=</span> <span class="fl">1.5</span> <span class="co"># time of "true" extinction</span></span>
<span><span class="va">r</span> <span class="op">=</span> <span class="fl">30</span> <span class="co"># rate of fossil occurrences</span></span>
<span><span class="co"># simulate rate fossil occurrences of taxon </span></span>
<span><span class="va">f_occ</span> <span class="op">=</span> <span class="fu"><a href="../reference/p3.html">p3</a></span><span class="op">(</span><span class="va">r</span>, from <span class="op">=</span> <span class="fu"><a href="https://mindthegap-erc.github.io/admtools/reference/min_time.html" class="external-link">min_time</a></span><span class="op">(</span><span class="va">adm_2km</span><span class="op">)</span>, to <span class="op">=</span> <span class="va">t_ext</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">f_occ</span><span class="op">)</span></span></code></pre></div>
<p><img src="event_data_files/figure-html/unnamed-chunk-9-1.png" width="700"></p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># stratigraphically highest fossil found</span></span>
<span><span class="va">highest_occ</span> <span class="op">=</span> <span class="va">f_occ</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://mindthegap-erc.github.io/admtools/reference/time_to_strat.html" class="external-link">time_to_strat</a></span><span class="op">(</span><span class="va">adm_2km</span>, destructive <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="co"># destroy fossil occurrences</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span>na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># stratigraphic position of "true" extinction</span></span>
<span><span class="va">h_true_ext</span> <span class="op">=</span> <span class="va">t_ext</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://mindthegap-erc.github.io/admtools/reference/time_to_strat.html" class="external-link">time_to_strat</a></span><span class="op">(</span><span class="va">adm_2km</span>, destructive <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> </span>
<span></span>
<span><span class="co"># distance between last occurence of taxon and location where they actually go extinct</span></span>
<span><span class="va">strat_range_offset_m</span> <span class="op">=</span> <span class="va">h_true_ext</span> <span class="op">-</span> <span class="va">highest_occ</span></span>
<span></span>
<span><span class="co"># time when last preserved fossil lived</span></span>
<span><span class="va">t_last_occ</span> <span class="op">=</span> <span class="va">highest_occ</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://mindthegap-erc.github.io/admtools/reference/strat_to_time.html" class="external-link">strat_to_time</a></span><span class="op">(</span><span class="va">adm_2km</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># time offset between true extinction and time when last fossil lived.</span></span>
<span><span class="va">time_range_offset_myr</span> <span class="op">=</span> <span class="va">t_ext</span> <span class="op">-</span> <span class="va">t_last_occ</span></span></code></pre></div>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dist</span> <span class="op">=</span> <span class="va">scenarioA</span><span class="op">$</span><span class="va">dist_from_shore</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># define age-depth model and attach units to it</span></span>
<span><span class="va">adm</span> <span class="op">=</span> <span class="fu"><a href="https://mindthegap-erc.github.io/admtools/reference/tp_to_adm.html" class="external-link">tp_to_adm</a></span><span class="op">(</span>t <span class="op">=</span> <span class="va">scenarioA</span><span class="op">$</span><span class="va">t_myr</span>,</span>
<span>                h <span class="op">=</span> <span class="va">scenarioA</span><span class="op">$</span><span class="va">h_m</span><span class="op">[</span>,<span class="va">dist</span><span class="op">]</span>,</span>
<span>                T_unit <span class="op">=</span> <span class="st">"Myr"</span>,</span>
<span>                L_unit <span class="op">=</span> <span class="st">"m"</span><span class="op">)</span></span>
<span><span class="co"># plot age-depth model</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">adm</span>,</span>
<span>     lwd_acc <span class="op">=</span> <span class="fl">2</span>,   <span class="co"># plot thicker lines for accumulative intervals (lwd = line width)</span></span>
<span>     lty_destr <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="co"># don't plot destructive intervals (lty = line type)</span></span>
<span><span class="fu"><a href="https://mindthegap-erc.github.io/admtools/reference/T_axis_lab.html" class="external-link">T_axis_lab</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># add time axis label</span></span>
<span><span class="fu"><a href="https://mindthegap-erc.github.io/admtools/reference/L_axis_lab.html" class="external-link">L_axis_lab</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># add length axis label</span></span></code></pre></div>
<p><img src="event_data_files/figure-html/unnamed-chunk-10-1.png" width="700"></p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/p3.html">p3</a></span><span class="op">(</span>rate <span class="op">=</span> <span class="fl">100</span>, from <span class="op">=</span> <span class="fu"><a href="https://mindthegap-erc.github.io/admtools/reference/min_time.html" class="external-link">min_time</a></span><span class="op">(</span><span class="va">adm</span><span class="op">)</span>, to <span class="op">=</span> <span class="fu"><a href="https://mindthegap-erc.github.io/admtools/reference/max_time.html" class="external-link">max_time</a></span><span class="op">(</span><span class="va">adm</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span>                  <span class="co"># simulate fossil occurrences in time</span></span>
<span>  <span class="fu"><a href="https://mindthegap-erc.github.io/admtools/reference/get_height.html" class="external-link">get_height</a></span><span class="op">(</span><span class="va">adm</span>, t <span class="op">=</span> <span class="va">_</span>, destructive <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">|&gt;</span>    <span class="co">#   transfrom into depth domain</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fu"><a href="https://mindthegap-erc.github.io/admtools/reference/min_height.html" class="external-link">min_height</a></span><span class="op">(</span><span class="va">adm</span><span class="op">)</span>, to <span class="op">=</span> <span class="fu"><a href="https://mindthegap-erc.github.io/admtools/reference/max_height.html" class="external-link">max_height</a></span><span class="op">(</span><span class="va">adm</span><span class="op">)</span>, length.out <span class="op">=</span> <span class="fl">20</span><span class="op">)</span>,</span>
<span>      main <span class="op">=</span> <span class="st">"Fossil occurrences"</span>,</span>
<span>       xlab <span class="op">=</span> <span class="st">"Height [m]"</span><span class="op">)</span></span></code></pre></div>
<p><img src="event_data_files/figure-html/unnamed-chunk-11-1.png" width="700"></p>
</div>
</div>
<div class="section level2">
<h2 id="influence-of-niches">Influence of niches<a class="anchor" aria-label="anchor" href="#influence-of-niches"></a>
</h2>
<p>We increase the complexity of the pipeline by incorporating niche
modeling. For this we need two components:</p>
<ul>
<li><p>a niche definition that describes how “comfortable” a species
feels along an environmental gradient</p></li>
<li><p>information on how that gradient changes with time</p></li>
</ul>
<p>In this example we focus on <em>water depth</em> as gradient as it is
included in the model outputs. The general modeling framework works for
any type of gradient.</p>
<p>First, we define the niche. We do this using the helper function
<code>cnd</code> (capped normal distribution). It is a probability
density function of the normal distribution, multiplied by the factor
<code>inc</code> and capped at 1. A 1 reflects that the taxon is fully
within its prefferred environment, and a 0 reflects that is is outside
of its environment.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_niche</span> <span class="op">=</span> <span class="fu"><a href="../reference/cnd.html">cnd</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="fl">10</span>, <span class="co"># preffered water depth </span></span>
<span>               sd <span class="op">=</span> <span class="fl">5</span>, <span class="co"># tolerance to water depth fluctiations</span></span>
<span>               inc <span class="op">=</span> <span class="fl">15</span>, <span class="co"># multiplier</span></span>
<span>               cut_neg <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co"># cut off negative avalues - the species does not surviva at land</span></span>
<span><span class="va">x</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span>, <span class="fl">30</span>, by <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">x</span>, <span class="fu">my_niche</span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, type <span class="op">=</span> <span class="st">"l"</span>, xlab <span class="op">=</span> <span class="st">"water depth"</span>, ylab <span class="op">=</span> <span class="st">"preference"</span><span class="op">)</span></span></code></pre></div>
<p><img src="event_data_files/figure-html/unnamed-chunk-12-1.png" width="700"></p>
<p>To get the gradient change with time, we extract water depth 2 km
offshore from the example data:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">t</span> <span class="op">=</span> <span class="va">scenarioA</span><span class="op">$</span><span class="va">t_myr</span></span>
<span><span class="va">wd</span> <span class="op">=</span> <span class="va">scenarioA</span><span class="op">$</span><span class="va">wd_m</span><span class="op">[</span>,<span class="st">"2km"</span><span class="op">]</span></span>
<span><span class="va">gc</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/approxfun.html" class="external-link">approxfun</a></span><span class="op">(</span><span class="va">t</span>, <span class="va">wd</span><span class="op">)</span> <span class="co"># define gradient change</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">t</span>, <span class="fu"><a href="https://rdrr.io/r/base/gc.html" class="external-link">gc</a></span><span class="op">(</span><span class="va">t</span><span class="op">)</span>, type <span class="op">=</span> <span class="st">"l"</span>, xlab <span class="op">=</span> <span class="st">"Time [Myr]"</span>, ylab <span class="op">=</span> <span class="st">"Water depth [m]"</span><span class="op">)</span></span></code></pre></div>
<p><img src="event_data_files/figure-html/unnamed-chunk-13-1.png" width="700"></p>
<p>Now we can combine these two ingredients to examine how the preffered
niche changes the fossil abundance in the time domain.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/p3.html">p3</a></span><span class="op">(</span>rate <span class="op">=</span> <span class="fl">300</span>, from <span class="op">=</span> <span class="fu"><a href="https://mindthegap-erc.github.io/admtools/reference/min_time.html" class="external-link">min_time</a></span><span class="op">(</span><span class="va">adm_2km</span><span class="op">)</span>, to <span class="op">=</span> <span class="fu"><a href="https://mindthegap-erc.github.io/admtools/reference/max_time.html" class="external-link">max_time</a></span><span class="op">(</span><span class="va">adm_2km</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/apply_niche_pref.html">apply_niche_pref</a></span><span class="op">(</span>niche_def <span class="op">=</span> <span class="va">my_niche</span>, gc <span class="op">=</span> <span class="va">gc</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span>xlab <span class="op">=</span> <span class="st">"Time [Myr]"</span>, main <span class="op">=</span> <span class="st">"Fossil abundance"</span><span class="op">)</span></span></code></pre></div>
<p><img src="event_data_files/figure-html/unnamed-chunk-14-1.png" width="700"></p>
<p>Here you can see that the taxon only occurs at times where the water
depth is favorable for it. Around 2 Myr, the water depth is too shallow,
and the fossil abundance is reduced.</p>
<p>With the basic niche modeling done, we can now combine it with the
stratigrahic distortion by age-depth models to get an idea how niche
preferences change the fossil abundance in the section.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/p3.html">p3</a></span><span class="op">(</span>rate <span class="op">=</span> <span class="fl">300</span>, from <span class="op">=</span> <span class="fu"><a href="https://mindthegap-erc.github.io/admtools/reference/min_time.html" class="external-link">min_time</a></span><span class="op">(</span><span class="va">adm_2km</span><span class="op">)</span>, to <span class="op">=</span> <span class="fu"><a href="https://mindthegap-erc.github.io/admtools/reference/max_time.html" class="external-link">max_time</a></span><span class="op">(</span><span class="va">adm_2km</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/apply_niche_pref.html">apply_niche_pref</a></span><span class="op">(</span>niche_def <span class="op">=</span> <span class="va">my_niche</span>, gc <span class="op">=</span> <span class="va">gc</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://mindthegap-erc.github.io/admtools/reference/time_to_strat.html" class="external-link">time_to_strat</a></span><span class="op">(</span><span class="va">adm_2km</span>, destructive <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span>xlab <span class="op">=</span> <span class="st">"Stratigraphic height [m]"</span>,</span>
<span>       main <span class="op">=</span> <span class="st">"Fossil abundance"</span><span class="op">)</span></span></code></pre></div>
<p><img src="event_data_files/figure-html/unnamed-chunk-15-1.png" width="700"></p>
<p>We can see a general decrease in fossil abundance, but no longer gaps
as were visible in the time domain. The latter is because the gaps in
fossil abundance in the time domain coincide with hiatuses, and will
thus not be visible in the stratigraphic domain. The general decrease in
fossil abundance is because as the carbonate platform ages, the water
depth on the platform is decreasing:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"t"</span> <span class="op">=</span> <span class="va">t</span>, <span class="st">"y"</span> <span class="op">=</span> <span class="va">wd</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://mindthegap-erc.github.io/admtools/reference/time_to_strat.html" class="external-link">time_to_strat</a></span><span class="op">(</span><span class="va">adm_2km</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span>orientation <span class="op">=</span> <span class="st">"lr"</span>, type <span class="op">=</span> <span class="st">"l"</span>, xlab <span class="op">=</span> <span class="st">"Stratigraphic position [m]"</span>, ylab <span class="op">=</span> <span class="st">"Water depth [m]"</span><span class="op">)</span></span></code></pre></div>
<p><img src="event_data_files/figure-html/unnamed-chunk-16-1.png" width="700"></p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Niklas Hohmann.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
