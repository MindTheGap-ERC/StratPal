<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Usage with the paleoTS and evoTS package • StratPal</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Usage with the paleoTS and evoTS package">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">StratPal</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.5.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/StratPal.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/event_data.html">Stratigraphic Paleobiology for Event Data</a></li>
    <li><a class="dropdown-item" href="../articles/phenotypic_evolution.html">Stratigraphic Paleobiology for Phenotypic Evolution</a></li>
    <li><a class="dropdown-item" href="../articles/paleoTS_functionality.html">Usage with the paleoTS and evoTS package</a></li>
    <li><a class="dropdown-item" href="../articles/advanced_functionality.html">Advanced Functionality and Writing Extensions</a></li>
    <li><a class="dropdown-item" href="../articles/StratPal_docs.html">Documentation of defined S3 classes</a></li>
    <li><a class="dropdown-item" href="../articles/FossilSim_integration.html">Integration with the FossilSim and paleotree packages</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/MindTheGap-ERC/StratPal/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Usage with the paleoTS and evoTS package</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/MindTheGap-ERC/StratPal/blob/main/vignettes/paleoTS_functionality.Rmd" class="external-link"><code>vignettes/paleoTS_functionality.Rmd</code></a></small>
      <div class="d-none name"><code>paleoTS_functionality.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://mindthegap-erc.github.io/StratPal/">StratPal</a></span><span class="op">)</span></span></code></pre></div>
<p>This vignette explain how to link the <code>StratPal</code> package
with the <code>paleoTS</code> and <code>evoTS</code> packages (<a href="#References">Hunt 2006, Voje 2023</a>). For details on the
underlying data structures, see
<code><a href="../articles/StratPal_docs.html">vignette("StratPal_docs")</a></code>.</p>
<div class="section level2">
<h2 id="quick-summary">Quick summary<a class="anchor" aria-label="anchor" href="#quick-summary"></a>
</h2>
<p>To combine the <code>StratPal</code> and the
<code>paleoTS</code>/<code>evoTS</code> packages,</p>
<ol style="list-style-type: decimal">
<li>simulate trait evolution using the functions with suffix
<code>_sl</code> (specimen level), optionally specifying the additional
parameters for intrapopulation variance and number of specimens</li>
<li>build your pipelines as before (e.g., as described in
<code><a href="../articles/phenotypic_evolution.html">vignette("phenotypic_evolution")</a></code>)</li>
<li>turn the result into <code>paleoTS</code> format using
<code>reduce_to_paleoTS</code>
</li>
<li>further analyze or plot the results using the <code>paleoTS</code>
or <code>evoTS</code> package</li>
</ol>
<p>Note that simulation of multivariate phenotypic evolution as provided
by the <code>evoTS</code> package is not yet implemented on specimen
level. If you are interested in this functionality please contact the
developer.</p>
</div>
<div class="section level2">
<h2 id="motivation">Motivation<a class="anchor" aria-label="anchor" href="#motivation"></a>
</h2>
<p>The <code>paleoTS</code> package allows to easily analyze
paleontological time series, and <code>StratPal</code> can be connected
to it to study how ecological, taphonomic, and stratigraphic effects
change our inferences about the tempo and mode of evolution.</p>
<p>The <code>paleoTS</code> package defines its own <code>paleoTS</code>
format to store time series. It is a summary format, as it combines
trait values measured in multiple specimens into an intrapopulation
variance. Because taphonomic and ecological effects act on individual
specimens, they can not be modeled directly on the <code>paleoTS</code>
format. To circumvent this problem, we introduce a
<code>pre_paleoTS</code> format that models trait evolution on the
specimen level. Stratigraphic, taphonomic, and ecological effects can
act on this format. After all these effects have been applied, we can
reduce this data format into the standard <code>paleoTS</code> format,
and then analyze it with the standard toolbox of the
<code>paloeTS</code>/<code>evoTS</code> packages.</p>
</div>
<div class="section level2">
<h2 id="modeling-trait-evolution-on-specimen-level-complexity-reduction-and-plotting">Modeling trait evolution on specimen level, complexity reduction,
and plotting<a class="anchor" aria-label="anchor" href="#modeling-trait-evolution-on-specimen-level-complexity-reduction-and-plotting"></a>
</h2>
<p>Functions to model trait evolution on specimen level have the suffix
<code>_sl</code>, standing for “specimen level”. Internally, they are of
S3 class <code>pre_paleoTS</code>. In addition to the options provided
to simulate mean trait values, you can simulate strict stasis using
<code>strict_stasis_sl</code>. All functions have the same
parametrization as the as the other functions for simulating trait
evolution, which simulate mean trait evolution. In addition, they take
two additional parameters: <code>intrapop_var</code> for the variance of
the population around the mean trait value, and
<code>n_per_sample</code> for the number of specimens per sampling
location.</p>
<p><code>pre_paleoTS</code> results can be converted to the
<code>paleoTS</code> format using the function
<code>reduce_to_paleoTS</code>. After this you can plot them with the
standard plotting procedure from paleoTS using <code>plot</code> (resp,
<code>plot.paleoTS</code>). Note that you can not plot
<code>pre_paloeTS</code> objects directly, only after conversion to
<code>paleoTS</code> format.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://mindthegap-erc.github.io/StratPal/">StratPal</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">paleoTS</span><span class="op">)</span>   <span class="co"># needed for plotting</span></span>
<span></span>
<span><span class="fu"><a href="../reference/strict_stasis_sl.html">strict_stasis_sl</a></span><span class="op">(</span>t <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span> <span class="op">|&gt;</span>   <span class="co"># simulate strict stasis on specimen level in `pre_paleoTS` format</span></span>
<span>  <span class="fu"><a href="../reference/reduce_to_paleoTS.html">reduce_to_paleoTS</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span>       <span class="co"># convert pre_paleoTS to paleoTS</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="op">)</span>                       <span class="co"># plot</span></span></code></pre></div>
<p><img src="paleoTS_functionality_files/figure-html/unnamed-chunk-2-1.png" alt="plot of strict stasis" width="700"></p>
</div>
<div class="section level2">
<h2 id="modeling-of-ecological-taphonomic-and-stratigraphic-effects">Modeling of ecological, taphonomic, and stratigraphic effects<a class="anchor" aria-label="anchor" href="#modeling-of-ecological-taphonomic-and-stratigraphic-effects"></a>
</h2>
<p>Modeling of niches, taphonomic effects, and stratigraphic biases
works on <code>pre_paleoTS</code> objects identical to how it is
described in the vignettes on event data and modeling phenotypic
evolution. As example, we plot a random walk 2 km offshore with 5
specimens per sampling location:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/MindTheGap-ERC/admtools" class="external-link">admtools</a></span><span class="op">)</span>                                  <span class="co"># load admtools for stratigraphic transformation</span></span>
<span><span class="va">adm</span> <span class="op">=</span> <span class="fu"><a href="https://mindthegap-erc.github.io/admtools/reference/tp_to_adm.html" class="external-link">tp_to_adm</a></span><span class="op">(</span>t <span class="op">=</span> <span class="va">scenarioA</span><span class="op">$</span><span class="va">t_myr</span>,               <span class="co"># define age-depth model</span></span>
<span>                h <span class="op">=</span> <span class="va">scenarioA</span><span class="op">$</span><span class="va">h_m</span><span class="op">[</span>,<span class="st">"2km"</span><span class="op">]</span>,</span>
<span>                L_unit <span class="op">=</span> <span class="st">"m"</span>,</span>
<span>                T_unit <span class="op">=</span> <span class="st">"Myr"</span><span class="op">)</span>    </span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span>                                      <span class="co"># set seed for reproducibility</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fu"><a href="https://mindthegap-erc.github.io/admtools/reference/min_time.html" class="external-link">min_time</a></span><span class="op">(</span><span class="va">adm</span><span class="op">)</span>, <span class="fu"><a href="https://mindthegap-erc.github.io/admtools/reference/max_time.html" class="external-link">max_time</a></span><span class="op">(</span><span class="va">adm</span><span class="op">)</span>, by <span class="op">=</span> <span class="fl">0.01</span><span class="op">)</span> <span class="op">|&gt;</span>   <span class="co"># sample every 0.01 Myr</span></span>
<span>  <span class="fu"><a href="../reference/random_walk_sl.html">random_walk_sl</a></span><span class="op">(</span>n_per_sample <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> <span class="op">|&gt;</span>            <span class="co"># simulate random walk on specimen level</span></span>
<span>  <span class="fu"><a href="https://mindthegap-erc.github.io/admtools/reference/time_to_strat.html" class="external-link">time_to_strat</a></span><span class="op">(</span><span class="va">adm</span><span class="op">)</span> <span class="op">|&gt;</span>                           <span class="co"># transform into stratigraphic domain</span></span>
<span>  <span class="fu"><a href="../reference/reduce_to_paleoTS.html">reduce_to_paleoTS</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span>                          <span class="co"># transform into paleoTS format</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="op">)</span>                                          <span class="co"># plot</span></span></code></pre></div>
<p><img src="paleoTS_functionality_files/figure-html/unnamed-chunk-3-1.png" alt="plot of a random walk after stratigraphic transformation" width="700"></p>
<p>Of course you can also immediately add functions from
<code>paleoTS</code> to the pipeline, e.g. to fit models of phenotypic
evolution from the simulated data:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span>                                      <span class="co"># set seed for reproducibility</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fu"><a href="https://mindthegap-erc.github.io/admtools/reference/min_time.html" class="external-link">min_time</a></span><span class="op">(</span><span class="va">adm</span><span class="op">)</span>, <span class="fu"><a href="https://mindthegap-erc.github.io/admtools/reference/max_time.html" class="external-link">max_time</a></span><span class="op">(</span><span class="va">adm</span><span class="op">)</span>, by <span class="op">=</span> <span class="fl">0.01</span><span class="op">)</span> <span class="op">|&gt;</span>   <span class="co"># sample every 0.01 Myr</span></span>
<span>  <span class="fu"><a href="../reference/random_walk_sl.html">random_walk_sl</a></span><span class="op">(</span>n_per_sample <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> <span class="op">|&gt;</span>            <span class="co"># simulate random walk on specimen level</span></span>
<span>  <span class="fu"><a href="https://mindthegap-erc.github.io/admtools/reference/time_to_strat.html" class="external-link">time_to_strat</a></span><span class="op">(</span><span class="va">adm</span><span class="op">)</span> <span class="op">|&gt;</span>                           <span class="co"># transform into stratigraphic domain</span></span>
<span>  <span class="fu"><a href="../reference/reduce_to_paleoTS.html">reduce_to_paleoTS</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span>                          <span class="co"># transform into paleoTS format</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/paleoTS/man/fit3models.html" class="external-link">fit3models</a></span><span class="op">(</span><span class="op">)</span>                                    <span class="co"># fit 3 models to time series</span></span>
<span><span class="co">#&gt; Warning in</span></span>
<span><span class="co">#&gt; fit3models(reduce_to_paleoTS(time_to_strat(random_walk_sl(seq(min_time(adm), :</span></span>
<span><span class="co">#&gt; Sample variances not equal (P = 0 ); consider using argument pool=FALSE</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Comparing 3 models [n = 64, method = Joint]</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;             logL K     AICc     dAICc Akaike.wt</span></span>
<span><span class="co">#&gt; GRW    -47.74893 3 101.8979  1.646129     0.305</span></span>
<span><span class="co">#&gt; URW    -48.02751 2 100.2517  0.000000     0.695</span></span>
<span><span class="co">#&gt; Stasis -57.64831 2 119.4933 19.241610     0.000</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="References">References<a class="anchor" aria-label="anchor" href="#References"></a>
</h2>
<ul>
<li><p>Hunt, Gene. 2006. “Fitting and Comparing Models of Phyletic
Evolution: Random Walks and Beyond.” Paleobiology. <a href="https://doi.org/10.1666/05070.1" class="external-link uri">https://doi.org/10.1666/05070.1</a>.</p></li>
<li><p>Voje, Kjetil L. 2023. “Fitting and Evaluating Univariate and
Multivariate Models of Within-Lineage Evolution.” Paleobiology. <a href="https://doi.org/10.1017/pab.2023.10" class="external-link uri">https://doi.org/10.1017/pab.2023.10</a>.</p></li>
</ul>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Niklas Hohmann.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

    </footer>
</div>





  </body>
</html>
