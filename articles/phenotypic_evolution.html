<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Stratigraphic Paleobiology for Phenotypic Evolution • StratPal</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Stratigraphic Paleobiology for Phenotypic Evolution">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">StratPal</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.3.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/StratPal.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/event_data.html">Stratigraphic Paleobiology for Event Data</a></li>
    <li><a class="dropdown-item" href="../articles/phenotypic_evolution.html">Stratigraphic Paleobiology for Phenotypic Evolution</a></li>
    <li><a class="dropdown-item" href="../articles/paleoTS_functionality.html">Usage with the paleoTS and evoTS package</a></li>
    <li><a class="dropdown-item" href="../articles/advanced_functionality.html">Advanced Functionality and Writing Extensions</a></li>
    <li><a class="dropdown-item" href="../articles/StratPal_docs.html">Documentation of defined S3 classes</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/MindTheGap-ERC/StratPal/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Stratigraphic Paleobiology for Phenotypic Evolution</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/MindTheGap-ERC/StratPal/blob/main/vignettes/phenotypic_evolution.Rmd" class="external-link"><code>vignettes/phenotypic_evolution.Rmd</code></a></small>
      <div class="d-none name"><code>phenotypic_evolution.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>Here we describe the modeling pipeline for the stratigraphic
paleobiology of phenotypic evolution. For details how this can be
combined with the <code>paleoTS</code> package (<a href="#References">Hunt 2006</a>), see</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/vignette.html" class="external-link">vignette</a></span><span class="op">(</span><span class="st">"paleoTS_functionality"</span><span class="op">)</span></span></code></pre></div>
<p>First, let’s load all required packages:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://mindthegap-erc.github.io/StratPal/">StratPal</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/MindTheGap-ERC/admtools" class="external-link">admtools</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="modes-of-evolution-in-the-time-domain">Modes of evolution in the time domain<a class="anchor" aria-label="anchor" href="#modes-of-evolution-in-the-time-domain"></a>
</h2>
<div class="section level3">
<h3 id="implemented-modes-of-evolution">Implemented modes of evolution<a class="anchor" aria-label="anchor" href="#implemented-modes-of-evolution"></a>
</h3>
<p>The <code>StratPal</code> package provides three functions for
simulating different modes of evolution in the time domain:</p>
<ul>
<li><p><code>stasis</code> simulates evolutionary stasis as independent,
normally distributed random variables with mean <code>mean</code> and
standard deviation <code>sd</code> (<a href="#References">Hunt
2006</a>).</p></li>
<li><p><code>random_walk</code> simulates trait evolution following a
(potentially biased) random walk with variability <code>sigma</code>,
directionality <code>mu</code>, and initial trait value <code>y0</code>
(e.g. <a href="#References">Bookstein 1987</a>). Setting <code>mu</code>
to a negative (positive) value will make the value of the random walk
decrease (increase) over time, <code>sigma</code> determines the effect
of randomness on the trait values.</p></li>
<li><p><code>ornstein_uhlenbeck</code> corresponds to convergence to a
phenotypic optimum, where <code>mu</code> is the optimal value (long
term mean), <code>theta</code> determines how fast <code>mu</code> is
approached, <code>sigma</code> the noise level, and <code>y0</code> the
initial trait value (<a href="#References">Lande 1976</a>).</p></li>
</ul>
<p>Use <code><a href="../articles/advanced_functionality.html">vignette("advanced_functionality")</a></code> for guidelines to
implement your own modes of evolution.</p>
</div>
<div class="section level3">
<h3 id="visualization">Visualization<a class="anchor" aria-label="anchor" href="#visualization"></a>
</h3>
<p>You can visualize the different modes of evolution using the
following pipeline:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, by <span class="op">=</span> <span class="fl">0.01</span><span class="op">)</span> <span class="op">|&gt;</span>             <span class="co"># times of simulation in Myr. Simulate over 1 Myr years with 10 kyr resolution</span></span>
<span>  <span class="fu"><a href="../reference/random_walk.html">random_walk</a></span><span class="op">(</span>sigma <span class="op">=</span> <span class="fl">1</span>, mu <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="co"># simulate random walk with increasing trait values</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"l"</span>,                  <span class="co"># plot results</span></span>
<span>       xlab <span class="op">=</span> <span class="st">"Time [Myr]"</span>,</span>
<span>       ylab <span class="op">=</span> <span class="st">"Trait value"</span><span class="op">)</span></span></code></pre></div>
<p><img src="phenotypic_evolution_files/figure-html/unnamed-chunk-3-1.png" alt="plot of a random walk" width="700"></p>
<p><strong>Task:</strong> Modify the pipeline to get an intuition for
the different modes of evolution. What are the effects of their
parameters, and what is their biological meaning?</p>
</div>
</div>
<div class="section level2">
<h2 id="stratigraphic-domain">Stratigraphic domain<a class="anchor" aria-label="anchor" href="#stratigraphic-domain"></a>
</h2>
<p>We are interested in how phenotypic evolution is preserved in the
stratigraphic record, i.e. how trait evolution within a lineage is
preserved at a specific location in the stratigraphic record. Here we
develop the modeling pipelines to answer this question.</p>
<div class="section level3">
<h3 id="age-depth-models">Age-depth models<a class="anchor" aria-label="anchor" href="#age-depth-models"></a>
</h3>
<p>As an example, we compare the preservation of trait evolution 2 km
and 12 km offshore in the carbonate platform in scenario A from <a href="#References">Hohmann et al. (2024)</a>. See
<code><a href="../reference/scenarioA.html">?scenarioA</a></code> and <code><a href="../articles/StratPal.html">vignette("StratPal")</a></code> for
details on scenario A.</p>
<p>First define the age-depth models:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">adm_2km</span> <span class="op">=</span> <span class="fu"><a href="https://mindthegap-erc.github.io/admtools/reference/tp_to_adm.html" class="external-link">tp_to_adm</a></span><span class="op">(</span>t <span class="op">=</span> <span class="va">scenarioA</span><span class="op">$</span><span class="va">t_myr</span>,    <span class="co"># 2 km from shore</span></span>
<span>                h <span class="op">=</span> <span class="va">scenarioA</span><span class="op">$</span><span class="va">h_m</span><span class="op">[</span>,<span class="st">"2km"</span><span class="op">]</span>,</span>
<span>                T_unit <span class="op">=</span> <span class="st">"Myr"</span>,</span>
<span>                L_unit <span class="op">=</span> <span class="st">"m"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">adm_12km</span> <span class="op">=</span> <span class="fu"><a href="https://mindthegap-erc.github.io/admtools/reference/tp_to_adm.html" class="external-link">tp_to_adm</a></span><span class="op">(</span>t <span class="op">=</span> <span class="va">scenarioA</span><span class="op">$</span><span class="va">t_myr</span>,   <span class="co"># 12 km from shore</span></span>
<span>                h <span class="op">=</span> <span class="va">scenarioA</span><span class="op">$</span><span class="va">h_m</span><span class="op">[</span>,<span class="st">"12km"</span><span class="op">]</span>,</span>
<span>                T_unit <span class="op">=</span> <span class="st">"Myr"</span>,</span>
<span>                L_unit <span class="op">=</span> <span class="st">"m"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">adm_2km</span>,       <span class="co"># plot age-depth model 2 km from shore</span></span>
<span>     lwd_acc <span class="op">=</span> <span class="fl">2</span>,   <span class="co"># plot thicker lines for intervals with sediment accumulation (lwd = line width)</span></span>
<span>     lty_destr <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="co"># don't plot destructive intervals/gaps (lty = line type)</span></span>
<span><span class="fu"><a href="https://mindthegap-erc.github.io/admtools/reference/T_axis_lab.html" class="external-link">T_axis_lab</a></span><span class="op">(</span><span class="op">)</span>        <span class="co"># add time axis label</span></span>
<span><span class="fu"><a href="https://mindthegap-erc.github.io/admtools/reference/L_axis_lab.html" class="external-link">L_axis_lab</a></span><span class="op">(</span><span class="op">)</span>        <span class="co"># add length axis label</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/title.html" class="external-link">title</a></span><span class="op">(</span><span class="st">"Age-depth model 2 km from shore"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">adm_12km</span>,      <span class="co"># plot age-depth model 12 km from shore</span></span>
<span>     lwd_acc <span class="op">=</span> <span class="fl">2</span>,   </span>
<span>     lty_destr <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> </span>
<span><span class="fu"><a href="https://mindthegap-erc.github.io/admtools/reference/T_axis_lab.html" class="external-link">T_axis_lab</a></span><span class="op">(</span><span class="op">)</span> </span>
<span><span class="fu"><a href="https://mindthegap-erc.github.io/admtools/reference/L_axis_lab.html" class="external-link">L_axis_lab</a></span><span class="op">(</span><span class="op">)</span> </span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/title.html" class="external-link">title</a></span><span class="op">(</span><span class="st">"Age-depth model 12 km from shore"</span><span class="op">)</span></span></code></pre></div>
<p><img src="phenotypic_evolution_files/figure-html/figures-side-1.png" alt="2 plots of age-depth models, one 2 km from shore and one 12 km from shore" width="50%"><img src="phenotypic_evolution_files/figure-html/figures-side-2.png" alt="2 plots of age-depth models, one 2 km from shore and one 12 km from shore" width="50%"></p>
</div>
<div class="section level3">
<h3 id="stratigraphic-expression-of-phenotypic-evolution">Stratigraphic expression of phenotypic evolution<a class="anchor" aria-label="anchor" href="#stratigraphic-expression-of-phenotypic-evolution"></a>
</h3>
<p>We use the defined age-depth models to transform the simulated trait
values from the time domain into the depth domain via
<code>time_to_strat</code>:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fu"><a href="https://mindthegap-erc.github.io/admtools/reference/min_time.html" class="external-link">min_time</a></span><span class="op">(</span><span class="va">adm_2km</span><span class="op">)</span>, to <span class="op">=</span> <span class="fu"><a href="https://mindthegap-erc.github.io/admtools/reference/max_time.html" class="external-link">max_time</a></span><span class="op">(</span><span class="va">adm_2km</span><span class="op">)</span>, by <span class="op">=</span> <span class="fl">0.01</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="co"># sample every 10 kyr over the interval covered by the adm </span></span>
<span>  <span class="fu"><a href="../reference/random_walk.html">random_walk</a></span><span class="op">(</span>sigma <span class="op">=</span> <span class="fl">1</span>, mu <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">|&gt;</span>                                 <span class="co"># simulate random walk</span></span>
<span>  <span class="fu"><a href="https://mindthegap-erc.github.io/admtools/reference/time_to_strat.html" class="external-link">time_to_strat</a></span><span class="op">(</span><span class="va">adm_2km</span>, destructive <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">|&gt;</span>                    <span class="co"># transform data from time to strat domain</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"l"</span>,                                                  <span class="co"># plot</span></span>
<span>       orientation <span class="op">=</span> <span class="st">"lr"</span>,</span>
<span>       xlab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Stratigraphic height ["</span>, <span class="fu"><a href="https://mindthegap-erc.github.io/admtools/reference/get_L_unit.html" class="external-link">get_L_unit</a></span><span class="op">(</span><span class="va">adm_2km</span><span class="op">)</span>, <span class="st">"]"</span><span class="op">)</span>,</span>
<span>       ylab <span class="op">=</span> <span class="st">"Trait value"</span>,</span>
<span>       main <span class="op">=</span> <span class="st">"Trait evolution 2 km from shore"</span><span class="op">)</span></span></code></pre></div>
<p><img src="phenotypic_evolution_files/figure-html/unnamed-chunk-4-1.png" alt="plot of the stratigraphic experssion of a random walk 2 km from shore." width="700"></p>
<p>This is what a biased random walk in the time domain would look like
if it was observed 2 km offshore in the simulated carbonate platform.
The large jumps in traits correspond to long hiatuses caused by
prolonged drops in relative sea level (<a href="#References">Hohmann et
al. 2024</a>). Compare this figure to the random walk in the time domain
(without stratigraphic distortions).</p>
<p>12 km offshore, the preservation is very different:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fu"><a href="https://mindthegap-erc.github.io/admtools/reference/min_time.html" class="external-link">min_time</a></span><span class="op">(</span><span class="va">adm_12km</span><span class="op">)</span>, to <span class="op">=</span> <span class="fu"><a href="https://mindthegap-erc.github.io/admtools/reference/max_time.html" class="external-link">max_time</a></span><span class="op">(</span><span class="va">adm_12km</span><span class="op">)</span>, by <span class="op">=</span> <span class="fl">0.01</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="co"># sample every 10 kyr over the interval covered by the adm </span></span>
<span>  <span class="fu"><a href="../reference/random_walk.html">random_walk</a></span><span class="op">(</span>sigma <span class="op">=</span> <span class="fl">1</span>, mu <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">|&gt;</span>                                   <span class="co"># simulate random walk</span></span>
<span>  <span class="fu"><a href="https://mindthegap-erc.github.io/admtools/reference/time_to_strat.html" class="external-link">time_to_strat</a></span><span class="op">(</span><span class="va">adm_12km</span>, destructive <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">|&gt;</span>                     <span class="co"># transform data from time to strat domain</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"l"</span>,                                                    <span class="co"># plot results</span></span>
<span>       orientation <span class="op">=</span> <span class="st">"lr"</span>,</span>
<span>       xlab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Stratigraphic height ["</span>, <span class="fu"><a href="https://mindthegap-erc.github.io/admtools/reference/get_L_unit.html" class="external-link">get_L_unit</a></span><span class="op">(</span><span class="va">adm_12km</span><span class="op">)</span>, <span class="st">"]"</span><span class="op">)</span>,</span>
<span>       ylab <span class="op">=</span> <span class="st">"Trait value"</span>,</span>
<span>       main <span class="op">=</span> <span class="st">"Trait evolution 12 km from shore"</span><span class="op">)</span></span></code></pre></div>
<p><img src="phenotypic_evolution_files/figure-html/unnamed-chunk-5-1.png" alt="plot of the stratigraphic expression of a random walk 12 km from shore." width="700"></p>
<p>You can also see two jumps, but the first is at a different location
compared to the section 2 km offshore. Looking at the age-depth models,
we can see why this is: 2 km offshore, the jumps are caused by prolonged
hiatuses that are associated with the massive drops in sea level around
0.5 Myr and 1.5 Myr. 12 km offshore, the age-depth model shows fewer
gaps, but prolonged intervals with low sedimentation rates at the
beginning of the simulation and at around 1.5 Myr. This leads to
intervals where the rate phenotypic evolution appears to be accelerated
because of (sedimentological) condensation (<a href="#References">Hohmann 2021</a>). You can see that not all
artefactual jumps in traits observable in the stratigraphic record are
caused by gaps.</p>
<p><strong>Task:</strong> How does this effect vary between different
modes of evolution (with different parameter choices), and at different
locations in the platform (e.g., along an onshore-offshore gradient)?
Can you make any general statements about where you see the strongest
effects?</p>
</div>
<div class="section level3">
<h3 id="prescribing-a-sampling-strategy">Prescribing a sampling strategy<a class="anchor" aria-label="anchor" href="#prescribing-a-sampling-strategy"></a>
</h3>
<p>The above plots already give us a good idea of how stratigraphic
effects can change our interpretation of trait evolution.</p>
<p>However, there is a small imperfection. Because we simulate the
lineage every 10 kyr, it is sampled irregularly in the stratigraphic
domain: If sedimentation rates are high, samples can be multiple meters
apart, but if sedimentation rates are low, they are only a few
centimeters apart.</p>
<p>To fix this, we want to prescribe where in the stratigraphic domain
samples are taken. This allows us to examine the effect that different
sampling strategies have on our perception of trait evolution. We do
this in the following steps:</p>
<ol style="list-style-type: decimal">
<li>Determine sampling locations in the stratigraphic domain.</li>
<li>Calculate what times correspond to said sampling locations via
<code>strat_to_time</code>.</li>
<li>Simulate a lineage at said times.</li>
<li>Transform the simulated trait values back into the stratigraphic
domain using <code>time_to_strat</code>.</li>
<li>Plot the result.</li>
</ol>
<p>Let’s assume we take a sample every 2 meters. Then our five steps
above result in the following modeling pipeline:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dist_between_samples_m</span> <span class="op">=</span> <span class="fl">2</span></span>
<span><span class="va">sampling_loc_m</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fl">0.5</span> <span class="op">*</span> <span class="va">dist_between_samples_m</span>,</span>
<span>                     to <span class="op">=</span> <span class="fu"><a href="https://mindthegap-erc.github.io/admtools/reference/max_height.html" class="external-link">max_height</a></span><span class="op">(</span><span class="va">adm_2km</span><span class="op">)</span>,</span>
<span>                     by <span class="op">=</span> <span class="va">dist_between_samples_m</span><span class="op">)</span></span>
<span></span>
<span><span class="va">sampling_loc_m</span> <span class="op">|&gt;</span>                                  <span class="co"># sampling locations</span></span>
<span>  <span class="fu"><a href="https://mindthegap-erc.github.io/admtools/reference/strat_to_time.html" class="external-link">strat_to_time</a></span><span class="op">(</span><span class="va">adm_2km</span><span class="op">)</span> <span class="op">|&gt;</span>                        <span class="co"># determine times where lineage is sampled</span></span>
<span>  <span class="fu"><a href="../reference/random_walk.html">random_walk</a></span><span class="op">(</span>sigma <span class="op">=</span> <span class="fl">1</span>, mu <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">|&gt;</span>                <span class="co"># simulate trait values at these times</span></span>
<span>  <span class="fu"><a href="https://mindthegap-erc.github.io/admtools/reference/time_to_strat.html" class="external-link">time_to_strat</a></span><span class="op">(</span><span class="va">adm_2km</span>, destructive <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">|&gt;</span>   <span class="co"># transform trait values to stratigraphic domain</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span>orientation <span class="op">=</span> <span class="st">"lr"</span>,                         <span class="co"># plot stratigraphic data</span></span>
<span>       type <span class="op">=</span> <span class="st">"l"</span>,        </span>
<span>       ylab <span class="op">=</span> <span class="st">"Trait Value"</span>,</span>
<span>       xlab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Stratigraphic height ["</span>, <span class="fu"><a href="https://mindthegap-erc.github.io/admtools/reference/get_L_unit.html" class="external-link">get_L_unit</a></span><span class="op">(</span><span class="va">adm_2km</span><span class="op">)</span>, <span class="st">"]"</span><span class="op">)</span>,</span>
<span>       main <span class="op">=</span> <span class="st">"Trait evolution 2 km from shore"</span><span class="op">)</span></span></code></pre></div>
<p><img src="phenotypic_evolution_files/figure-html/unnamed-chunk-6-1.png" alt="plot of the stratigraphic expression of a random walk 2 km from shore, sampled every 2 km." width="700"></p>
<p>There we have it! This is what the lineage would look like if it was
sampled every 2 meters in a sections 2 km from shore.</p>
<p><strong>Task:</strong> How does prescribing a sampling strategy
change the interpretations of your last task? Can you draw any
conclusions about which sampling strategy is best suited for a given
environment or mode of evolution?</p>
</div>
</div>
<div class="section level2">
<h2 id="further-reading">Further reading<a class="anchor" aria-label="anchor" href="#further-reading"></a>
</h2>
<p>For details on how the <code>paleoTS</code> and <code>evoTS</code>
packages (<a href="#References">Hunt 2006, Voje 2023</a>) can be
integrated with the <code>StratPal</code> package, see</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/vignette.html" class="external-link">vignette</a></span><span class="op">(</span><span class="st">"paleoTS_functionality"</span><span class="op">)</span></span></code></pre></div>
<p>Run</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/vignette.html" class="external-link">vignette</a></span><span class="op">(</span><span class="st">"event_data"</span><span class="op">)</span></span></code></pre></div>
<p>for details on how to model stratigraphic paleobiology of event data
such as individual fossils and first/last occurrences of taxa, or
explore the vignette online under <a href="https://mindthegap-erc.github.io/StratPal/articles/event_data.html">mindthegap-erc.github.io/StratPal/articles/event_data</a>.</p>
<p>See also</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/vignette.html" class="external-link">vignette</a></span><span class="op">(</span><span class="st">"advanced_functionality"</span><span class="op">)</span></span></code></pre></div>
<p>for details on how to expand on the modeling pipelines described
here, or explore the vignette online under <a href="https://mindthegap-erc.github.io/StratPal/articles/advanced_functionality.html">mindthegap-erc.github.io/StratPal/articles/advanced_functionality</a>.</p>
</div>
<div class="section level2">
<h2 id="References">References<a class="anchor" aria-label="anchor" href="#References"></a>
</h2>
<ul>
<li><p>Bookstein, Fred L. 1987. “Random walk and the existence of
evolutionary rates.” Paleobiology. <a href="https://doi.org/10.1017/S0094837300009039" class="external-link uri">https://doi.org/10.1017/S0094837300009039</a>.</p></li>
<li><p>Hohmann, Niklas. 2021. “Incorporating information on varying
sedimentation rates into paleontological analyses.” PALAIOS. <a href="https://doi.org/10.2110/palo.2020.038" class="external-link uri">https://doi.org/10.2110/palo.2020.038</a>.</p></li>
<li><p>Hohmann, Niklas; Koelewijn, Joël R.; Burgess, Peter; Jarochowska,
Emilia. 2024. “Identification of the mode of evolution in incomplete
carbonate successions”. BMC Ecology and Evolution 24, 113. <a href="https://doi.org/10.1186/s12862-024-02287-2" class="external-link uri">https://doi.org/10.1186/s12862-024-02287-2</a>.</p></li>
<li><p>Hunt, Gene. 2006. “Fitting and Comparing Models of Phyletic
Evolution: Random Walks and Beyond.” Paleobiology. <a href="https://doi.org/10.1666/05070.1" class="external-link uri">https://doi.org/10.1666/05070.1</a>.</p></li>
<li><p>Lande, Russell. 1976. “Natural selection and random genetic drift
in phenotypic evolution.” Evolution. <a href="https://doi.org/10.1111/j.1558-5646.1976.tb00911.x" class="external-link uri">https://doi.org/10.1111/j.1558-5646.1976.tb00911.x</a>.</p></li>
<li><p>Voje, Kjetil L. 2023. “Fitting and Evaluating Univariate and
Multivariate Models of Within-Lineage Evolution.” Paleobiology. <a href="https://doi.org/10.1017/pab.2023.10" class="external-link uri">https://doi.org/10.1017/pab.2023.10</a>.</p></li>
</ul>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Niklas Hohmann.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
