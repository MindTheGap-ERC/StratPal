[{"path":"https://mindthegap-erc.github.io/StratPal/articles/StratPal.html","id":"overview","dir":"Articles","previous_headings":"","what":"Overview","title":"Intoduction to the StratPal package","text":"Welcome StratPal package. vignette provides overview structure package preliminaries needed efficiently use . go dependencies, piping, working age-depth models. want skip introduction, go details model stratigraphic paleobiology events fossil occurrences first/last occurrences. Go details model stratigraphic paleobiology trait evolution.","code":"vignette(\"fossil_occ\") vignette(\"trait_evolution\")"},{"path":"https://mindthegap-erc.github.io/StratPal/articles/StratPal.html","id":"dependencies","dir":"Articles","previous_headings":"","what":"Dependencies","title":"Intoduction to the StratPal package","text":"StratPal heavily relies age-depth modelling tools provided admtools package. make sure latest version package installed, first install remotes package running console. can install latest version admtools GitHub running also ask update dependent packages. provide brief overview functionality admtools package need. want information, can browse package vignettes using visiting package website https://mindthegap-erc.github.io/admtools/.","code":"install.packages(\"remotes\") remotes::install_github(repo = \"MindTheGap-ERC/admtools\",                         build_vignettes = TRUE,                         ref = \"HEAD\",                         dependencies = TRUE) browseVignettes(package = \"admtools\") # opens in Browser"},{"path":"https://mindthegap-erc.github.io/StratPal/articles/StratPal.html","id":"piping","dir":"Articles","previous_headings":"","what":"Piping","title":"Intoduction to the StratPal package","text":"StratPal package vignettes, make heavy use base R pipe operator |>. required run package, simplifies code makes underlying logic modeling pipeline clearer. functionality available R version 4.2 .","code":""},{"path":"https://mindthegap-erc.github.io/StratPal/articles/StratPal.html","id":"motivation-and-usage","dir":"Articles","previous_headings":"Piping","what":"Motivation and usage","title":"Intoduction to the StratPal package","text":"Consider following code simulating plotting random walk using random_walk function:  code job, flaws: introduced lot intermediate variables, makes hard trace logic : plotting random walk. Using pipe operator |> can clarify logic simplify code:  see code thing: plots random walk, one step without intermediate variables chaining together commands using pipe |>. becomes powerful tool combine components longer modeling pipelines. also makes code readable, can simply read left right, without track intermediate steps. Semantically, can read |> “take data left |> use first argument function right |>.","code":"t = seq(0, 1, by = 0.01) # times where we evaluate the random walk l = random_walk(t)       # simulate the random walk plot(l, type = \"l\")      # line plot of the results seq(0, 1, by = 0.01) |> # define times of simulation     random_walk() |>      # simulate random walk   plot(type = \"l\")      # plot"},{"path":"https://mindthegap-erc.github.io/StratPal/articles/StratPal.html","id":"advanced-usage","dir":"Articles","previous_headings":"Piping","what":"Advanced usage","title":"Intoduction to the StratPal package","text":"can also use |> pass arguments first place. , simply replace argument underscore _:","code":"# calculate deciles of normal distribution seq(0, 1, by = 0.1) |> quantile(x = runif(100), p = _) # pass left hand side to the p argument #>          0%         10%         20%         30%         40%         50%  #> 0.007208941 0.093878876 0.203263406 0.288367090 0.383532604 0.481074212  #>         60%         70%         80%         90%        100%  #> 0.546083320 0.663919001 0.774815967 0.885731729 0.995962664"},{"path":"https://mindthegap-erc.github.io/StratPal/articles/StratPal.html","id":"age-depth-models","dir":"Articles","previous_headings":"","what":"Age-depth models","title":"Intoduction to the StratPal package","text":"StratPal package makes heavy use age-depth modeling functionality admtools package. go basics dealing age-depth models. details available functionality can browse package vignettes using visit package website https://mindthegap-erc.github.io/admtools/. get started, first load package using StratPal package comes example data fro age-depth models, available variable scenarioA, see ?scenarioA details content.","code":"browseVignettes(package = \"admtools\") # opens in Browser library(\"admtools\")"},{"path":"https://mindthegap-erc.github.io/StratPal/articles/StratPal.html","id":"defining-age-depth-models","dir":"Articles","previous_headings":"Age-depth models","what":"Defining age-depth models","title":"Intoduction to the StratPal package","text":"Let’s start defining age-depth model. can done tp_to_adm (tie points age-depth model):","code":"t = scenarioA$t_myr # extract time tie points h = scenarioA$h_m[,\"2km\"] # get height tie points 2 km offshore in the carbonate plarform of scenario A from Hohmann et al. 2024  # define age-depth model # h[i] is the stratigraphic position at time t[i] adm = tp_to_adm(t = t, # tie points in time                 h = h, # tie points at height                 T_unit = \"Myr\", # time unit of adm                 L_unit = \"m\")   # Length unit"},{"path":"https://mindthegap-erc.github.io/StratPal/articles/StratPal.html","id":"plotting","dir":"Articles","previous_headings":"Age-depth models","what":"Plotting","title":"Intoduction to the StratPal package","text":"Now can plot adm using basic plot command:","code":"# plot age-depth model, see ?plot.adm for details plot(adm,      lwd_acc = 2,   # plot thicker lines for accumulative intervals (lwd = line width)      lty_destr = 0) # don't plot destructive intervals (lty = line type) T_axis_lab() # add time axis label L_axis_lab() # add length axis label"},{"path":"https://mindthegap-erc.github.io/StratPal/articles/StratPal.html","id":"extracting-information","dir":"Articles","previous_headings":"Age-depth models","what":"Extracting information","title":"Intoduction to the StratPal package","text":"lot functionality available extract information age-depth model: can now use pipe operator first analysis age-depth model  becomes clear 8 shorter hiatuses (100 kyr) 2 long hiatuses duration 500 kyr.","code":"get_total_duration(adm) # time interval covered by adm #> [1] 1.999 get_total_thickness(adm) # sediment accumulated  #> [1] 145.9416 get_completeness(adm) # stratigraphic completeness #> [1] 0.3261631 summary(adm) # some summary statistics #> age-depth model  #> Total duration: 1.999 Myr #> Total thickness: 145.9416 m #> Stratigraphic completeness: 32.61631 %  #> 10 hiatus(es) # plot histogram of hiatus durations adm |>       get_hiat_duration() |>   hist( xlab = paste(\"Hiatus duration\", \"[\", get_T_unit(adm),\"]\"))"},{"path":"https://mindthegap-erc.github.io/StratPal/articles/StratPal.html","id":"transforming-data","dir":"Articles","previous_headings":"Age-depth models","what":"Transforming data","title":"Intoduction to the StratPal package","text":"Given stratigraphic position, age-depth model can tell us old positions . Conversely, know timing event, age-depth model can tell us stratigraphic position event occur. can used transfrom types data time domain stratigraphic domain vice versa. admtools, transformation data done functions time_to_strat (transforming temporal data stratigraphic data) strat_to_time (transforming stratigrahic data temporal data). Details done types data can transformed can found vignettes (see section ).","code":""},{"path":"https://mindthegap-erc.github.io/StratPal/articles/StratPal.html","id":"getting-started","dir":"Articles","previous_headings":"","what":"Getting started","title":"Intoduction to the StratPal package","text":"preliminaries way, can go go details model stratigraphic paleobiology events fossil occurrences first/last occurrences. Go details model stratigraphic paleobiology trait evolution.","code":"vignette(\"fossil_occ\") vignette(\"trait_evolution\")"},{"path":"https://mindthegap-erc.github.io/StratPal/articles/fossil_occ.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Stratigraphic Paleobiology for fossil occurrences","text":"vignette provides introduction stratigraphic paleobiology applied fossil occurrences first/last taxon occurrences.","code":""},{"path":"https://mindthegap-erc.github.io/StratPal/articles/fossil_occ.html","id":"modeling-fossil-occurrences-and-firstlast-fossil-occurrences","dir":"Articles","previous_headings":"","what":"Modeling fossil occurrences and first/last fossil occurrences","title":"Stratigraphic Paleobiology for fossil occurrences","text":"Fossil occurrences first/last occurrences can considered distinct events occur specific points time stratigraphic position. model point processes. StratPal package, provide two functions simulate point processes: p3, short Poisson point process, simulate events occur constant rate p3_var_rate variable rate Poisson point processes simulate events occur variable rates (e.g. extinction events etc.) usage p3 straightforward:  p3_var_rate, can pass either function specifies rate:  Alternatively, can pass two vectors x y. rate determined linear interpolation vectors. equivalent using function approxfun(x,y)  Note matter interpretation whether “events” produced p3 p3_var_rate fossil occurrences first/last occurrences. conceptual framework holds nonetheless.","code":"# simulate fossil occurrences over one Myr with an average of 8 occurrences per Myr p3(rate = 8, from = 0, to = 1) |>   hist(main = \"Fossil occurrences\",        xlab = \"Time [Myr]\") # return 100 occurrences by setting n parameter p3_var_rate(sin, from = 0, to = 9, n = 100) |>   hist(xlab = \"Time [Myr]\", main = \"Fossil occurrences\") # note that negative rates (where sin < 0) are ignored # decline in fossil occurrences from 50 to 0 over 1 Myr p3_var_rate(x = c(0,1), y = c(50, 0), from = 0, to = 1, f_max = 50) |>   hist(xlab = \"Time [Myr]\", main = \"Fossil occurrences\")"},{"path":"https://mindthegap-erc.github.io/StratPal/articles/fossil_occ.html","id":"age-depth-models","dir":"Articles","previous_headings":"","what":"Age-depth models","title":"Stratigraphic Paleobiology for fossil occurrences","text":"Throughout examples, use two age-depth model, 2 km 12 km offshore scenario . define ","code":"# define ADM 2 km from shore adm_2km = tp_to_adm(t = scenarioA$t_myr,                 h = scenarioA$h_m[,\"2km\"],                 T_unit = \"Myr\",                 L_unit = \"m\")  adm_12km = tp_to_adm(t = scenarioA$t_myr,                 h = scenarioA$h_m[,\"12km\"],                 T_unit = \"Myr\",                 L_unit = \"m\")  # plot age-depth model plot(adm_2km,      lwd_acc = 2,   # plot thicker lines for accumulative intervals (lwd = line width)      lty_destr = 0) # don't plot destructive intervals (lty = line type) T_axis_lab() # add time axis label L_axis_lab() # add length axis label plot(adm_12km,      lwd_acc = 2,   # plot thicker lines for accumulative intervals (lwd = line width)      lty_destr = 0) # don't plot destructive intervals (lty = line type) T_axis_lab() # add time axis label L_axis_lab() # add length axis label"},{"path":[]},{"path":"https://mindthegap-erc.github.io/StratPal/articles/fossil_occ.html","id":"fossil-occurrences","dir":"Articles","previous_headings":"Stratigraphic distortions of “event” type data","what":"Fossil occurrences","title":"Stratigraphic Paleobiology for fossil occurrences","text":"“event” type data can directly transformed using time_to_strat:  Note option destructive = TRUE time_to_strat. makes sure fossil occurrences coincide hiatus destroyed, appear stratigraphic domain. pattern looks different 2 km offshore:  section much shorter (even 20 m), ther 2 distinct peaks bottom section around 13 m. Comparing age-depth model shows locations correspond times extreme stratigraphic condensation (low sedimentation rates, indicated near-horizontal age-depth model). result, time represented per stratigraphic increment, leading accumulations fossil occurrences.","code":"p3(rate = 200, from = min_time(adm_2km), to = max_time(adm_2km)) |>   time_to_strat(adm_2km, destructive = TRUE) |>   hist(xlab = \"Stratigraphic height [m]\",        main = \"Fossil occurrences 2 km offshore\",        breaks = seq(from = min_height(adm_2km), to = max_height(adm_2km), length.out = 20)) p3(rate = 200, from = min_time(adm_12km), to = max_time(adm_12km)) |>   time_to_strat(adm_12km, destructive = TRUE) |>   hist(xlab = \"Stratigraphic height [m]\",        main = \"Fossil occurrences 12 km offshore\",        breaks = seq(from = min_height(adm_12km), to = max_height(adm_12km), length.out = 20))"},{"path":"https://mindthegap-erc.github.io/StratPal/articles/fossil_occ.html","id":"last-occurrences-of-common-taxa","dir":"Articles","previous_headings":"Stratigraphic distortions of “event” type data","what":"Last occurrences of common taxa","title":"Stratigraphic Paleobiology for fossil occurrences","text":"Last (first) occurrences can also directly transformed using time_to_strat condition taxa common. assumption explored .  pattern last occurrences section 2 km offshore extinction rate constant! peaks coincide hiatuses, last occurrences species disappear hiatus cluster hiatus surface. Note used option destructive = FALSE time_to_strat make sure last occurrences appear location hiatus. assumption abundant taxa important: taxa rare, last occurrence match actual time extinction (Signor-Lipps effect), last occurrences can found hiats. patter 12 km offshore different:  almost perfectly matches pattern fossil occurrences. offshore section much dominated condensation (influences fossil occurrences first/last occurrences equally), onshore section dominated hiatuses (affect first/last occurrences). shows important understand “event” type data affected hiatuses: preserved, destroyed?","code":"p3(rate = 200, from = min_time(adm_2km), to = max_time(adm_2km)) |>   time_to_strat(adm_2km, destructive = FALSE) |>   hist(xlab = \"Stratigraphic height [m]\",        main = \"Last occurrences 2 km offshore\",        breaks = seq(from = min_height(adm_2km), to = max_height(adm_2km), length.out = 20)) p3(rate = 200, from = min_time(adm_12km), to = max_time(adm_12km)) |>   time_to_strat(adm_12km, destructive = TRUE) |>   hist(xlab = \"Stratigraphic height [m]\",        main = \"Last occurrences 12 km offshore\",        breaks = seq(from = min_height(adm_12km), to = max_height(adm_12km), length.out = 20))"},{"path":"https://mindthegap-erc.github.io/StratPal/articles/fossil_occ.html","id":"range-offset","dir":"Articles","previous_headings":"Stratigraphic distortions of “event” type data","what":"Range offset","title":"Stratigraphic Paleobiology for fossil occurrences","text":"","code":"t_ext = 1.5 # time of \"true\" extinction r = 30 # rate of fossil occurrences # simulate rate fossil occurrences of taxon  f_occ = p3(r, from = min_time(adm_2km), to = t_ext) hist(f_occ) # stratigraphically highest fossil found highest_occ = f_occ |>   time_to_strat(adm_2km, destructive = TRUE) |> # destroy fossil occurrences   max(na.rm = TRUE)  # stratigraphic position of \"true\" extinction h_true_ext = t_ext |>   time_to_strat(adm_2km, destructive = FALSE)   # distance between last occurence of taxon and location where they actually go extinct strat_range_offset_m = h_true_ext - highest_occ  # time when last preserved fossil lived t_last_occ = highest_occ |>    strat_to_time(adm_2km)  # time offset between true extinction and time when last fossil lived. time_range_offset_myr = t_ext - t_last_occ dist = scenarioA$dist_from_shore[2]  # define age-depth model and attach units to it adm = tp_to_adm(t = scenarioA$t_myr,                 h = scenarioA$h_m[,dist],                 T_unit = \"Myr\",                 L_unit = \"m\") # plot age-depth model plot(adm,      lwd_acc = 2,   # plot thicker lines for accumulative intervals (lwd = line width)      lty_destr = 0) # don't plot destructive intervals (lty = line type) T_axis_lab() # add time axis label L_axis_lab() # add length axis label p3(rate = 100, from = min_time(adm), to = max_time(adm)) |>                  # simulate fossil occurrences in time   get_height(adm, t = _, destructive = FALSE) |>    #   transfrom into depth domain   hist(breaks = seq(min_height(adm), to = max_height(adm), length.out = 20),       main = \"Fossil occurrences\",        xlab = \"Height [m]\")"},{"path":"https://mindthegap-erc.github.io/StratPal/articles/fossil_occ.html","id":"influence-of-niches","dir":"Articles","previous_headings":"","what":"Influence of niches","title":"Stratigraphic Paleobiology for fossil occurrences","text":"increase complexity pipeline incorporating niche modeling. need two components: niche definition describes “comfortable” species feels along environmental gradient information gradient changes time example focus water depth gradient included model outputs. general modeling framework works type gradient. First, define niche. using helper function cnd (capped normal distribution). probability density function normal distribution, multiplied factor inc capped 1. 1 reflects taxon fully within prefferred environment, 0 reflects outside environment.  get gradient change time, extract water depth 2 km offshore example data:  Now can combine two ingredients examine preffered niche changes fossil abundance time domain.  can see taxon occurs times water depth favorable . Around 2 Myr, water depth shallow, fossil abundance reduced. basic niche modeling done, can now combine stratigrahic distortion age-depth models get idea niche preferences change fossil abundance section.  can see general decrease fossil abundance, longer gaps visible time domain. latter gaps fossil abundance time domain coincide hiatuses, thus visible stratigraphic domain. general decrease fossil abundance carbonate platform ages, water depth platform decreasing:","code":"my_niche = cnd(mean = 10, # preffered water depth                 sd = 5, # tolerance to water depth fluctiations                inc = 15, # multiplier                cut_neg = TRUE) # cut off negative avalues - the species does not surviva at land x = seq(-2, 30, by = 0.1) plot(x, my_niche(x), type = \"l\", xlab = \"water depth\", ylab = \"preference\") t = scenarioA$t_myr wd = scenarioA$wd_m[,\"2km\"] gc = approxfun(t, wd) # define gradient change plot(t, gc(t), type = \"l\", xlab = \"Time [Myr]\", ylab = \"Water depth [m]\") p3(rate = 300, from = min_time(adm_2km), to = max_time(adm_2km)) |>   apply_niche_pref(niche_def = my_niche, gc = gc) |>   hist(xlab = \"Time [Myr]\", main = \"Fossil abundance\") p3(rate = 300, from = min_time(adm_2km), to = max_time(adm_2km)) |>   apply_niche_pref(niche_def = my_niche, gc = gc) |>   time_to_strat(adm_2km, destructive = TRUE) |>   hist(xlab = \"Stratigraphic height [m]\",        main = \"Fossil abundance\") list(\"t\" = t, \"y\" = wd) |>   time_to_strat(adm_2km) |>    plot(orientation = \"lr\", type = \"l\", xlab = \"Stratigraphic position [m]\", ylab = \"Water depth [m]\")"},{"path":"https://mindthegap-erc.github.io/StratPal/articles/trait_evolution.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"trait_evolution","text":"describe modeling pipeline stratigraphic paleobiology trait evolution.","code":""},{"path":"https://mindthegap-erc.github.io/StratPal/articles/trait_evolution.html","id":"time-domain","dir":"Articles","previous_headings":"","what":"Time domain","title":"trait_evolution","text":"StratPal package provides three functions simulating trait evolution time domain: stasis simulates evolutionary stasis independent, normally distributed random variables mean mean standard deviation sd. random_walk simulates trait evolution following (potentially biased) random walk variability sigma, directionality mu, initial trait value y0. Setting mu negative (positive) value make random walk increase (decrease) time, sigma determines effect randomness trait values. ornstein_uhlenbeck corresponds convergence phenotypic optimum, mu optimal value (long term mean), theta determines strength selection, sigma influence chance, y0 initial trait value. can visualize using following pipeline:","code":"seq(0, 1, by = 0.01) |> # times of simulation in myr. simulate over 1 Myr years with 10 kyr resolution   random_walk(sigma = 1, mu = 3) |> # simulate random walk with incresing trait values   plot(type = \"l\", # plot results        xlab = \"Time [Myr]\",        ylab = \"Trait value\")"},{"path":"https://mindthegap-erc.github.io/StratPal/articles/trait_evolution.html","id":"stratigraphic-domain","dir":"Articles","previous_headings":"","what":"Stratigraphic domain","title":"trait_evolution","text":"interested stratigraphic expression phenotypic evolution, .e. trait evolution within lineage preserved specific location stratigraphic record. , first define age-depth model:  Now can use age-depth model transform simulated trait values time domain depth domain using time_to_strat:  can already see large jumps trait values gaps, missing lot time. already good start, small issues: simulate lineage every 10 kyr, lineage sampled irregular stratigraphic domain. example, get multiple conflicting trait values height gaps longer 10 kyr. get realistic result, need prescribe sampling strategy stratigraphic domain. following steps: Determine sampling locations Calculate times correspond said sampling locations via strat_to_time Simulate lineage said times Transform simulated trait values back stratigraphic domain using time_to_strat Plot result Let’s assume take sample every 2 meters. five steps result following modeling pipeline:  ! lineage look like sampled every 2 meters sections 2 km offshore. nicely see large jumps prolonged hiatuses.","code":"# define ADM 4 km from shore dist = scenarioA$dist_from_shore[2] adm = tp_to_adm(t = scenarioA$t_myr,                 h = scenarioA$h_m[,dist],                 T_unit = \"Myr\",                 L_unit = \"m\") # plot age-depth model plot(adm,      lwd_acc = 2,   # plot thicker lines for accumulative intervals (lwd = line width)      lty_destr = 0) # don't plot destructive intervals (lty = line type) T_axis_lab() # add time axis label L_axis_lab() # add length axis label # sample every 10 kyr over the interval covered by the adm  # simulate random walk # transform data from time to strat domain seq(from = min_time(adm), to = max_time(adm), by = 0.01) |>     random_walk(sigma = 1, mu = 3) |> # simulate random walk   time_to_strat(adm, destructive = FALSE) |>   plot(type = \"l\",        orientation = \"lr\",        xlab = \"Stratigraphic height [m]\",        ylab = \"Trait value\") dist_between_samples_m = 2 sampling_loc_m = seq(from = 0.5 * dist_between_samples_m,                      to = max_height(adm),                      by = dist_between_samples_m)  sampling_loc_m |>         # sampling locations   strat_to_time(adm) |>   # determine times where lineage is sampled   random_walk(sigma = 1, mu = 3) |> # simulate trait values at these times   time_to_strat(adm, destructive = FALSE) |>   # transform trait values to stratigraphic domain   plot(orientation = \"lr\",        type = \"l\",        # plot fossil time series        ylab = \"Trait Value\",        xlab = \"Stratigraphic Height [m]\")"},{"path":"https://mindthegap-erc.github.io/StratPal/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Niklas Hohmann. Author, maintainer.","code":""},{"path":"https://mindthegap-erc.github.io/StratPal/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Hohmann N (2024). StratPal: Modeling Stratigraphic Paleobiology. R package version 0.0.0.9000, https://mindthegap-erc.github.io/StratPal/.","code":"@Manual{,   title = {StratPal: Modeling Stratigraphic Paleobiology},   author = {Niklas Hohmann},   year = {2024},   note = {R package version 0.0.0.9000},   url = {https://mindthegap-erc.github.io/StratPal/}, }"},{"path":"https://mindthegap-erc.github.io/StratPal/index.html","id":"stratpal","dir":"","previous_headings":"","what":"Modeling Stratigraphic Paleobiology","title":"Modeling Stratigraphic Paleobiology","text":"R package Stratigraphic Paleobiology. DEVELOPMENT","code":""},{"path":"https://mindthegap-erc.github.io/StratPal/index.html","id":"authors","dir":"","previous_headings":"","what":"Authors","title":"Modeling Stratigraphic Paleobiology","text":"Niklas Hohmann Utrecht University email: n.hohmann [] uu.nl Web page: uu.nl/staff/NHohmann Orcid: 0000-0003-1559-1838","code":""},{"path":"https://mindthegap-erc.github.io/StratPal/index.html","id":"requirements","dir":"","previous_headings":"","what":"Requirements","title":"Modeling Stratigraphic Paleobiology","text":"R verion >= 4.2","code":""},{"path":"https://mindthegap-erc.github.io/StratPal/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Modeling Stratigraphic Paleobiology","text":"install package, first install remotes package running R console. , run install latest verision admtools package. Last, run","code":"install.packages(\"remotes\") remotes::install_github(repo = \"MindTheGap-ERC/admtools\",                         build_vignettes = TRUE,                         ref = \"HEAD\",                         dependencies = TRUE) remotes::install_github(repo = \"MindTheGap-ERC/StratPal\",                         build_vignettes = TRUE,                         ref = \"HEAD\",                         dependencies = TRUE)"},{"path":"https://mindthegap-erc.github.io/StratPal/index.html","id":"usage","dir":"","previous_headings":"","what":"Usage","title":"Modeling Stratigraphic Paleobiology","text":"Run view available vignettes use cases.","code":"browseVignettes(package = \"StratPal\")"},{"path":"https://mindthegap-erc.github.io/StratPal/index.html","id":"license","dir":"","previous_headings":"","what":"License","title":"Modeling Stratigraphic Paleobiology","text":"Apache 2.0, see LICENSE file license text.","code":""},{"path":"https://mindthegap-erc.github.io/StratPal/index.html","id":"copyright","dir":"","previous_headings":"","what":"Copyright","title":"Modeling Stratigraphic Paleobiology","text":"Copyright 2024 Netherlands eScience Center Utrecht University","code":""},{"path":"https://mindthegap-erc.github.io/StratPal/index.html","id":"references","dir":"","previous_headings":"","what":"References","title":"Modeling Stratigraphic Paleobiology","text":"package used data Identification mode evolution incomplete carbonate successions Niklas Hohmann, Joël R Koelewijn, Peter Burgess, Emilia Jarochowska bioRxiv 2023.12.18.572098; doi: https://doi.org/10.1101/2023.12.18.572098","code":""},{"path":"https://mindthegap-erc.github.io/StratPal/index.html","id":"funding-information","dir":"","previous_headings":"","what":"Funding information","title":"Modeling Stratigraphic Paleobiology","text":"Funded European Union (ERC, MindTheGap, StG project 101041077). Views opinions expressed however author(s) necessarily reflect European Union European Research Council. Neither European Union granting authority can held responsible .","code":""},{"path":"https://mindthegap-erc.github.io/StratPal/reference/apply_niche_pref.html","id":null,"dir":"Reference","previous_headings":"","what":"apply niche preference — apply_niche_pref","title":"apply niche preference — apply_niche_pref","text":"models niche preferences removing events (fossil occurrences) outside preferred niche using function thin Combines functions niche_def gc (\"gradient change\") determine taxons preferred environment changes time. done composing niche_def gc. result used thinning.","code":""},{"path":"https://mindthegap-erc.github.io/StratPal/reference/apply_niche_pref.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"apply niche preference — apply_niche_pref","text":"","code":"apply_niche_pref(x, niche_def, gc)"},{"path":"https://mindthegap-erc.github.io/StratPal/reference/apply_niche_pref.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"apply niche preference — apply_niche_pref","text":"x events, e.g. fossil occurrences niche_def function, specifying niche along gradient. return 0 taxon outside niche, 1 fully inside niche. Values 0 1 interpreted probabilities. gc function, stands \"gradient change\". Specifies gradient changes, e.g. time","code":""},{"path":"https://mindthegap-erc.github.io/StratPal/reference/apply_niche_pref.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"apply niche preference — apply_niche_pref","text":"","code":"if (FALSE) { # \\dontrun{ ## setup # using water depth as gradient  t = scenarioA$t_myr  wd = scenarioA$wd_m[,\"8km\"]  gc = approxfun(t, wd)  plot(t, gc(t), type = \"l\", xlab = \"Time\", ylab = \"water depth [m]\",   main = \"gradient change with time\")  # define niche  # preferred wd 10 m, tolerant to intermediate wd changes (standard deviation 10 m), non-terrestrial  niche_def = cnd(mean = 10, sd = 10, inc  = 40, cut_neg = TRUE)  plot(seq(-1, 50, by = 0.5), niche_def(seq(-1, 50, by = 0.5)), type = \"l\",  xlab = \"water depth\", ylab = \"preference\", main = \"Niche def\")  # niche pref with time  plot(t, niche_def(gc(t)), type = \"l\", xlab = \"time\", ylab = \"preference\", main = \"pref with time\")   ## simulate fossil occurrences  foss_occ = p3(rate = 100, from = 0, to = max(t))  # foss occ without niche pref  hist(foss_occ, xlab = \"time\")  foss_occ_niche = apply_niche_pref(foss_occ, niche_def, gc)  # fossil occurrences with niche preference  hist(foss_occ_niche, xlab = \"time\")  } # }"},{"path":"https://mindthegap-erc.github.io/StratPal/reference/cnd.html","id":null,"dir":"Reference","previous_headings":"","what":"capped normal distribution pdf — cnd","title":"capped normal distribution pdf — cnd","text":"returns function defines niche based capped normal distribution, .e. pdf normal distribution values 1 capped. Mathematically, f(x) = min( inc * pdf(x), 1)","code":""},{"path":"https://mindthegap-erc.github.io/StratPal/reference/cnd.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"capped normal distribution pdf — cnd","text":"","code":"cnd(mean, sd, inc = 1, cut_neg = TRUE)"},{"path":"https://mindthegap-erc.github.io/StratPal/reference/cnd.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"capped normal distribution pdf — cnd","text":"mean mean normal distribution sd standard deviation inc scalar, factor pdf multiplied cut_neg logical. negative values set 0?","code":""},{"path":"https://mindthegap-erc.github.io/StratPal/reference/cnd.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"capped normal distribution pdf — cnd","text":"function","code":""},{"path":"https://mindthegap-erc.github.io/StratPal/reference/cnd.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"capped normal distribution pdf — cnd","text":"","code":"if (FALSE) { # \\dontrun{ # using water depht as niche wd = seq(-3, 40, by = 0.5) f = cnd(mean = 10, sd = 5, inc = 15, cut_neg = FALSE) # 1 indicates high preference, 0 indicates low preference plot(wd, f(wd), xlab = \"Water depth\", ylab = \"Env. preference\") # set value at neg wd to 0 - non-terrestrial species. f = cnd(mean = 10, sd = 5, inc = 15, cut_neg = TRUE) plot(wd, f(wd), xlab = \"Water depth\", ylab = \"Env. preference\") } # }"},{"path":"https://mindthegap-erc.github.io/StratPal/reference/ornstein_uhlenbeck.html","id":null,"dir":"Reference","previous_headings":"","what":"simulate ornstein-uhlenbeck (OU) process — ornstein_uhlenbeck","title":"simulate ornstein-uhlenbeck (OU) process — ornstein_uhlenbeck","text":"simulates ornstein-uhlenbeck using Euler-Maruyame method. process simulated scale 0.25 * min(diff(t)) interpolated values t.","code":""},{"path":"https://mindthegap-erc.github.io/StratPal/reference/ornstein_uhlenbeck.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"simulate ornstein-uhlenbeck (OU) process — ornstein_uhlenbeck","text":"","code":"ornstein_uhlenbeck(t, mu = 0, theta = 1, sigma = 1, y0 = 0)"},{"path":"https://mindthegap-erc.github.io/StratPal/reference/ornstein_uhlenbeck.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"simulate ornstein-uhlenbeck (OU) process — ornstein_uhlenbeck","text":"t times process simulated mu numeric, long term mean theta numeric, mean reversion speed sigma positive scalar, strength randomness y0 scalar. initial value (value process first entry t)","code":""},{"path":"https://mindthegap-erc.github.io/StratPal/reference/ornstein_uhlenbeck.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"simulate ornstein-uhlenbeck (OU) process — ornstein_uhlenbeck","text":"list two elements: t y. t duplicate input t, y values OU process times. Outputs class timelist can thus plotted directly using plot, see ?plot.timelist","code":""},{"path":"https://mindthegap-erc.github.io/StratPal/reference/ornstein_uhlenbeck.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"simulate ornstein-uhlenbeck (OU) process — ornstein_uhlenbeck","text":"","code":"if (FALSE) { # \\dontrun{ library(\"admtools\") # required for plotting of results t = seq(0, 3, by = 0.01) l = ornstein_uhlenbeck(t, y0 = 3) # start away from optimum (mu) plot(l, type = \"l\") l2 = ornstein_uhlenbeck(t, y0 = 0) # start in optimum lines(l2$t, l2$y, col = \"red\") } # }"},{"path":"https://mindthegap-erc.github.io/StratPal/reference/p3.html","id":null,"dir":"Reference","previous_headings":"","what":"simulate Poisson point process — p3","title":"simulate Poisson point process — p3","text":"Simulates events interval based Poisson point process rate rate. parameter n used, number fossils conditioned n context paleontology, events can interpreted fossil occurrences first/last occurrences species. case, rate average number fossil occurrences (resp first/last occurrences) per unit","code":""},{"path":"https://mindthegap-erc.github.io/StratPal/reference/p3.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"simulate Poisson point process — p3","text":"","code":"p3(rate, from, to, n = NULL)"},{"path":"https://mindthegap-erc.github.io/StratPal/reference/p3.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"simulate Poisson point process — p3","text":"rate strictly positive scalar, rate events (avg events per unit) lowest boundary observed interval upper boundary observed interval n integer NULL (default). Number events return. NULL, number random determined rate parameter","code":""},{"path":[]},{"path":"https://mindthegap-erc.github.io/StratPal/reference/p3_var_rate.html","id":null,"dir":"Reference","previous_headings":"","what":"simulate variable rate Poisson point process — p3_var_rate","title":"simulate variable rate Poisson point process — p3_var_rate","text":"simulates events based variable rate Poisson point process. Rates can either specified function passed x, providing two vectors x y. case rate specified approxfun(x, y, rule = 2), .e. linear interpolation values x (abscissa) y (ordinate) context paleontology, events can interpreted fossil occurrences first/last occurrences species. case, rate average number fossil occurrences (resp first/last occurrences) per unit","code":""},{"path":"https://mindthegap-erc.github.io/StratPal/reference/p3_var_rate.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"simulate variable rate Poisson point process — p3_var_rate","text":"","code":"p3_var_rate(x, y = NULL, from = 0, to = 1, f_max = 1, n = NULL)"},{"path":"https://mindthegap-erc.github.io/StratPal/reference/p3_var_rate.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"simulate variable rate Poisson point process — p3_var_rate","text":"x numeric vector function. x function, used specify variable rate. x vector, x y together specify variable rate using linear interpolation y numeric vector. specified, determines variable rate. done using linear interpolation values y. x specifies ordinate y abscissa lower boundary observed interval upper boundary observed f_max maximum value x interval x_min x_max. x attains values larger f_max warning throw, f_max adjusted, sampling started n NULL integer. Number events drawn. NULL, number events determined rate (specified x y). integer passed, n events returned.","code":""},{"path":[]},{"path":"https://mindthegap-erc.github.io/StratPal/reference/random_walk.html","id":null,"dir":"Reference","previous_headings":"","what":"continuous time random walk — random_walk","title":"continuous time random walk — random_walk","text":"simulates random walk Brownian drift","code":""},{"path":"https://mindthegap-erc.github.io/StratPal/reference/random_walk.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"continuous time random walk — random_walk","text":"","code":"random_walk(t, sigma = 1, mu = 0, y0 = 0)"},{"path":"https://mindthegap-erc.github.io/StratPal/reference/random_walk.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"continuous time random walk — random_walk","text":"t numeric vector strictly increasing elements. Times random walk evaluated sigma variance parameter mu directionality parameter y0 starting value, .e. value random walk first entry t","code":""},{"path":"https://mindthegap-erc.github.io/StratPal/reference/random_walk.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"continuous time random walk — random_walk","text":"list elements t y. t duplicate input parameter times random walk evaluated. y values random walk said times","code":""},{"path":"https://mindthegap-erc.github.io/StratPal/reference/random_walk.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"continuous time random walk — random_walk","text":"","code":"if (FALSE) { # \\dontrun{ library(\"admtools\") # required for plotting of results t = seq(0, 1, by = 0.01) l = random_walk(t, sigma = 3) # high variability, no direction plot(l, type = \"l\") l2 = random_walk(t, mu = 1) # low variabliity, increasing trend lines(l2$t, l2$y, col = \"red\") } # }"},{"path":"https://mindthegap-erc.github.io/StratPal/reference/rej_samp.html","id":null,"dir":"Reference","previous_headings":"","what":"rejection sampling — rej_samp","title":"rejection sampling — rej_samp","text":"rejection sampling (pseudo) pdf f interval x_min x_max. Returns n samples. Note values f 0 capped zero","code":""},{"path":"https://mindthegap-erc.github.io/StratPal/reference/rej_samp.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"rejection sampling — rej_samp","text":"","code":"rej_samp(f, x_min, x_max, n = 1L, f_max = 1)"},{"path":"https://mindthegap-erc.github.io/StratPal/reference/rej_samp.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"rejection sampling — rej_samp","text":"f function. (pseudo) pdf sample drawn x_min scalar. lower limit examined interval x_max scalar. upper limit examined interval n integer. number samples drawn f_max maximum value f interval x_min x_max. f attains values larger f_max warning throw, f_max adjusted, sampling started ","code":""},{"path":"https://mindthegap-erc.github.io/StratPal/reference/rej_samp.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"rejection sampling — rej_samp","text":"","code":"if (FALSE) { # \\dontrun{ f = sin x = rej_samp(f, 0, 3*pi, n = 100) hist(x) # note that no samples are drawn where sin is negative } # }"},{"path":"https://mindthegap-erc.github.io/StratPal/reference/scenarioA.html","id":null,"dir":"Reference","previous_headings":"","what":"scenario A from Hohmann et al 2024 — scenarioA","title":"scenario A from Hohmann et al 2024 — scenarioA","text":"scenario Hohmann et al 2024","code":""},{"path":"https://mindthegap-erc.github.io/StratPal/reference/scenarioA.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"scenario A from Hohmann et al 2024 — scenarioA","text":"","code":"scenarioA"},{"path":"https://mindthegap-erc.github.io/StratPal/reference/scenarioA.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"scenario A from Hohmann et al 2024 — scenarioA","text":"list 6 elements: t_myr : numeric vector. timesteps simulation Myr sl_m : numeric vector. eustatic sea level m dist_from_shore : character vector. Distance shore km locations observations made h_m : matrix size length(t_myr) x length(dist_from_shore). Accumulated sediment height m examined locations wd_m: matrix size length(t_myr) x length(dist_from_shore). Water depth m examined locations strat_col: list length(dist_from shore) elements. Represents stratigraphic column. element list two elements bed_thickness_m: numeric vector. Bed thickness m facies_code : integer vector. facies code bed","code":""},{"path":"https://mindthegap-erc.github.io/StratPal/reference/stasis.html","id":null,"dir":"Reference","previous_headings":"","what":"simulate phenotypic stasis — stasis","title":"simulate phenotypic stasis — stasis","text":"simulates stasis independent, normally distributed random variables mean mean standard deviatin sd","code":""},{"path":"https://mindthegap-erc.github.io/StratPal/reference/stasis.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"simulate phenotypic stasis — stasis","text":"","code":"stasis(t, mean = 0, sd = 1)"},{"path":"https://mindthegap-erc.github.io/StratPal/reference/stasis.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"simulate phenotypic stasis — stasis","text":"t times phenotype determined mean mean value sd standard deviation","code":""},{"path":"https://mindthegap-erc.github.io/StratPal/reference/stasis.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"simulate phenotypic stasis — stasis","text":"","code":"if (FALSE) { # \\dontrun{  library(\"admtools\") # required for plotting of results  t = seq(0, 1, by = 0.01)  l = stasis(t)  plot(l, type = \"l\") # plot lineage  l2 = stasis(t, mean = 0.5, sd = 0.3) # simulate second lineage  lines(l2$t, l2$y, col = \"red\") # plot second lineage } # }"},{"path":"https://mindthegap-erc.github.io/StratPal/reference/thin.html","id":null,"dir":"Reference","previous_headings":"","what":"thin a series of events (e.g. fossil occurrences) — thin","title":"thin a series of events (e.g. fossil occurrences) — thin","text":"Thins vector events using function thin, meaning probability ith event x preserved given thin (x()). Values thin 0 1 ignored","code":""},{"path":"https://mindthegap-erc.github.io/StratPal/reference/thin.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"thin a series of events (e.g. fossil occurrences) — thin","text":"","code":"thin(x, thin)"},{"path":"https://mindthegap-erc.github.io/StratPal/reference/thin.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"thin a series of events (e.g. fossil occurrences) — thin","text":"x numeric vectors events (e.g. locations, height, times) thin function used thinning","code":""},{"path":"https://mindthegap-erc.github.io/StratPal/reference/thin.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"thin a series of events (e.g. fossil occurrences) — thin","text":"","code":"x = p3(rate = 100, from = 0, to = 3 * pi) # simulate Poisson point process y = thin(x, sin) hist(y) # not how negative values of sin are treated as 0  yy = thin(x, function(x) 5 * sin(x)) hist(yy) # note how values of 5 * sin above 1 are not affecting the thinning"}]
